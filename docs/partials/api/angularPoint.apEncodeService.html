<h1><code ng:non-bindable="">apEncodeService</code>
<div><span class="hint">service in module <code ng:non-bindable="">angularPoint</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="angularpoint-apencodeservice-page"><p>Processes JavaScript objects and converts them to a format SharePoint expects.</p>
</div></div>
<h2 id="dependencies">Dependencies</h2>
<ul class="dependencies"><li><code ng:non-bindable=""><a href="#/api/angularPoint.apConfig">apConfig</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/api/angularPoint.apUtilityService">apUtilityService</a></code>
</li>
</ul>
<div class="member method"><h2 id="methods">Methods</h2>
<ul class="methods"><li><h3 id="methods_createvaluepair">createValuePair(fieldDefinition, value)</h3>
<div class="createvaluepair"><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-createvaluepair-page"><p>Uses a field definition from a model to properly format a value for submission to SharePoint.  Typically
used prior to saving a list item, we iterate over each of the non-readonly properties defined in the model
for a list item and convert those value into value pairs that we can then hand off to SPServices.</p>
</div><h5 id="methods_createvaluepair_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>fieldDefinition</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-createvaluepair-page"><p>The field definition, typically defined in the model.
<pre class="prettyprint linenums">
{
 staticName: "Title",
 objectType: "Text",
 mappedName: "lastName",
 readOnly:false
}
</pre>
</div></td></tr><tr><td>value</td><td><a href="" class="label type-hint type-hint-object">*</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-createvaluepair-page"><p>Current field value.</p>
</div></td></tr></tbody></table><h5 id="methods_createvaluepair_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-array">Array</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-createvaluepair-page"><p>[fieldName, fieldValue]</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_generatevaluepairs">generateValuePairs(fieldDefinitions, item)</h3>
<div class="generatevaluepairs"><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-generatevaluepairs-page"><p>Typically used to iterate over the non-readonly field definitions stored in a model and convert a
given list item entity into value pairs that we can pass to SPServices for saving.</p>
</div><h5 id="methods_generatevaluepairs_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>fieldDefinitions</td><td><a href="" class="label type-hint type-hint-array">Array</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-generatevaluepairs-page"><p>Definitions from the model.</p>
</div></td></tr><tr><td>item</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-generatevaluepairs-page"><p>list item that we&#39;ll attempt to iterate over to find the properties that we need to
save it to SharePoint.</p>
</div></td></tr></tbody></table><h5 id="methods_generatevaluepairs_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-array">Array[]</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-generatevaluepairs-page"><p>Value pairs of all non-readonly fields. [[fieldName, fieldValue]]</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_stringifysharepointdate">stringifySharePointDate(date)</h3>
<div class="stringifysharepointdate"><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointdate-page"><p>Converts a JavaScript date into a modified ISO8601 date string using the TimeZone
offset for the current user.</p>
</div><h5 id="methods_stringifysharepointdate_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>date</td><td><a href="" class="label type-hint type-hint-date">Date</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointdate-page"><p>Valid JS date.</p>
</div></td></tr></tbody></table><h5 id="methods_stringifysharepointdate_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointdate-page"><p>ISO8601 date string.</p>
</div></td></tr></table><h4 id="methods_stringifysharepointdate_example">Example</h4>
<div class="example"><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointdate-page"><pre class="prettyprint linenums">'2014-05-08T08:12:18Z-07:00'</pre>
</div></div>
</div>
</li>
<li><h3 id="methods_stringifysharepointmultiselect">stringifySharePointMultiSelect(multiSelectValue, idProperty, valueProperty)</h3>
<div class="stringifysharepointmultiselect"><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointmultiselect-page"><p>Turns an array of, typically {lookupId: someId, lookupValue: someValue}, objects into a string
of delimited id&#39;s that can be passed to SharePoint for a multi select lookup or multi user selection
field.  SharePoint doesn&#39;t need the lookup values so we only need to pass the ID&#39;s back.</p>
</div><h5 id="methods_stringifysharepointmultiselect_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>multiSelectValue</td><td><a href="" class="label type-hint type-hint-object">object[]</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointmultiselect-page"><p>Array of {lookupId: #, lookupValue: &#39;Some Value&#39;} objects.</p>
</div></td></tr><tr><td>idProperty</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointmultiselect-page"><p>Property name where we&#39;ll find the ID value on each of the objects.</p>
</div> <p><em>(default: 'lookupId')</em></p></td></tr><tr><td>valueProperty</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointmultiselect-page"><p>Property name where we&#39;ll find the value for this object.</p>
</div> <p><em>(default: 'lookupValue')</em></p></td></tr></tbody></table><h5 id="methods_stringifysharepointmultiselect_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="angularpoint-apencodeservice-page angularpoint-apencodeservice-stringifysharepointmultiselect-page"><p>Need to format string of id&#39;s in following format [ID0];#;#[ID1];#;#[ID1]</p>
</div></td></tr></table></div>
</li>
</ul>
</div>
</div>
