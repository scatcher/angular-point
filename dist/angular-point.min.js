/**
 * angular-point - A library designed to allow Angular to work with SharePoint lists using SOAP web services.
 * @authors Scott <angular-point@scotthatcher.com>
 * @version v1.2.5
 * @link https://github.com/scatcher/angular-point
 * @license MIT
 */
"use strict";try{angular.module("toastr")}catch(e){angular.module("toastr",[]).factory("toastr",["$log",function(e){return{error:e.error,info:e.info,success:e.info,warning:e.warn}}])}angular.module("angularPoint",["toastr"]),angular.module("angularPoint").config(["apConfig",function(e){e.online=!e.offline}]),function(){angular.module("angularPoint").constant("apConfig",{appTitle:"Angular-Point",debug:!1,defaultQueryName:"primary",defaultUrl:"",environment:"production",firebaseURL:"The optional url of your firebase source",offline:window.location.href.indexOf("localhost")>-1||window.location.href.indexOf("http://0.")>-1||window.location.href.indexOf("http://10.")>-1||window.location.href.indexOf("http://192.")>-1,offlineXML:"dev/"})}(),function(){angular.module("angularPoint").constant("apDefaultFields",[{staticName:"ID",objectType:"Counter",mappedName:"id",readOnly:!0},{staticName:"Modified",objectType:"DateTime",mappedName:"modified",readOnly:!0},{staticName:"Created",objectType:"DateTime",mappedName:"created",readOnly:!0},{staticName:"Author",objectType:"User",mappedName:"author",readOnly:!0},{staticName:"Editor",objectType:"User",mappedName:"editor",readOnly:!0},{staticName:"PermMask",objectType:"Mask",mappedName:"permMask",readOnly:!0},{staticName:"UniqueId",objectType:"String",mappedName:"uniqueId",readOnly:!0},{staticName:"FileRef",objectType:"Lookup",mappedName:"fileRef",readOnly:!0}])}(),function(){angular.module("angularPoint").constant("apDefaultListItemQueryOptions","<QueryOptions>   <IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns>   <IncludeAttachmentUrls>TRUE</IncludeAttachmentUrls>   <IncludeAttachmentVersion>FALSE</IncludeAttachmentVersion>   <ExpandUserField>FALSE</ExpandUserField></QueryOptions>")}(),angular.module("angularPoint").constant("_",_),angular.module("angularPoint").constant("apWebServiceOperationConstants",{GetAlerts:["Alerts",!1],DeleteAlerts:["Alerts",!0],Mode:["Authentication",!1],Login:["Authentication",!1],CopyIntoItems:["Copy",!0],CopyIntoItemsLocal:["Copy",!0],GetItem:["Copy",!1],GetForm:["Forms",!1],GetFormCollection:["Forms",!1],AddAttachment:["Lists",!0],AddDiscussionBoardItem:["Lists",!0],AddList:["Lists",!0],AddListFromFeature:["Lists",!0],ApplyContentTypeToList:["Lists",!0],CheckInFile:["Lists",!0],CheckOutFile:["Lists",!0],CreateContentType:["Webs",!0],DeleteAttachment:["Lists",!0],DeleteContentType:["Lists",!0],DeleteContentTypeXmlDocument:["Lists",!0],DeleteList:["Lists",!0],GetAttachmentCollection:["Lists",!1],GetList:["Lists",!1],GetListAndView:["Lists",!1],GetListCollection:["Lists",!1],GetListContentType:["Lists",!1],GetListContentTypes:["Lists",!1],GetListItemChanges:["Lists",!1],GetListItemChangesSinceToken:["Lists",!1],GetListItems:["Lists",!1],GetVersionCollection:["Lists",!1],UndoCheckOut:["Lists",!0],UpdateContentType:["Webs",!0],UpdateContentTypesXmlDocument:["Lists",!0],UpdateContentTypeXmlDocument:["Lists",!0],UpdateList:["Lists",!0],UpdateListItems:["Lists",!0],AddMeeting:["Meetings",!0],CreateWorkspace:["Meetings",!0],RemoveMeeting:["Meetings",!0],SetWorkSpaceTitle:["Meetings",!0],ResolvePrincipals:["People",!1],SearchPrincipals:["People",!1],AddPermission:["Permissions",!0],AddPermissionCollection:["Permissions",!0],GetPermissionCollection:["Permissions",!0],RemovePermission:["Permissions",!0],RemovePermissionCollection:["Permissions",!0],UpdatePermission:["Permissions",!0],GetLinks:["PublishedLinksService",!0],GetPortalSearchInfo:["Search",!1],GetQuerySuggestions:["Search",!1],GetSearchMetadata:["Search",!1],Query:["Search",!1],QueryEx:["Search",!1],Registration:["Search",!1],Status:["Search",!1],SendClientScriptErrorReport:["SharePointDiagnostics",!0],GetAttachments:["SiteData",!1],EnumerateFolder:["SiteData",!1],SiteDataGetList:["SiteData",!1],SiteDataGetListCollection:["SiteData",!1],SiteDataGetSite:["SiteData",!1],SiteDataGetSiteUrl:["SiteData",!1],SiteDataGetWeb:["SiteData",!1],CreateWeb:["Sites",!0],DeleteWeb:["Sites",!0],GetSite:["Sites",!1],GetSiteTemplates:["Sites",!1],AddComment:["SocialDataService",!0],AddTag:["SocialDataService",!0],AddTagByKeyword:["SocialDataService",!0],CountCommentsOfUser:["SocialDataService",!1],CountCommentsOfUserOnUrl:["SocialDataService",!1],CountCommentsOnUrl:["SocialDataService",!1],CountRatingsOnUrl:["SocialDataService",!1],CountTagsOfUser:["SocialDataService",!1],DeleteComment:["SocialDataService",!0],DeleteRating:["SocialDataService",!0],DeleteTag:["SocialDataService",!0],DeleteTagByKeyword:["SocialDataService",!0],DeleteTags:["SocialDataService",!0],GetAllTagTerms:["SocialDataService",!1],GetAllTagTermsForUrlFolder:["SocialDataService",!1],GetAllTagUrls:["SocialDataService",!1],GetAllTagUrlsByKeyword:["SocialDataService",!1],GetCommentsOfUser:["SocialDataService",!1],GetCommentsOfUserOnUrl:["SocialDataService",!1],GetCommentsOnUrl:["SocialDataService",!1],GetRatingAverageOnUrl:["SocialDataService",!1],GetRatingOfUserOnUrl:["SocialDataService",!1],GetRatingOnUrl:["SocialDataService",!1],GetRatingsOfUser:["SocialDataService",!1],GetRatingsOnUrl:["SocialDataService",!1],GetSocialDataForFullReplication:["SocialDataService",!1],GetTags:["SocialDataService",!0],GetTagsOfUser:["SocialDataService",!0],GetTagTerms:["SocialDataService",!0],GetTagTermsOfUser:["SocialDataService",!0],GetTagTermsOnUrl:["SocialDataService",!0],GetTagUrlsOfUser:["SocialDataService",!0],GetTagUrlsOfUserByKeyword:["SocialDataService",!0],GetTagUrls:["SocialDataService",!0],GetTagUrlsByKeyword:["SocialDataService",!0],SetRating:["SocialDataService",!0],UpdateComment:["SocialDataService",!0],SpellCheck:["SpellCheck",!1],AddTerms:["TaxonomyClientService",!0],GetChildTermsInTerm:["TaxonomyClientService",!1],GetChildTermsInTermSet:["TaxonomyClientService",!1],GetKeywordTermsByGuids:["TaxonomyClientService",!1],GetTermsByLabel:["TaxonomyClientService",!1],GetTermSets:["TaxonomyClientService",!1],AddGroup:["usergroup",!0],AddGroupToRole:["usergroup",!0],AddRole:["usergroup",!0],AddRoleDef:["usergroup",!0],AddUserCollectionToGroup:["usergroup",!0],AddUserCollectionToRole:["usergroup",!0],AddUserToGroup:["usergroup",!0],AddUserToRole:["usergroup",!0],GetAllUserCollectionFromWeb:["usergroup",!1],GetGroupCollection:["usergroup",!1],GetGroupCollectionFromRole:["usergroup",!1],GetGroupCollectionFromSite:["usergroup",!1],GetGroupCollectionFromUser:["usergroup",!1],GetGroupCollectionFromWeb:["usergroup",!1],GetGroupInfo:["usergroup",!1],GetRoleCollection:["usergroup",!1],GetRoleCollectionFromGroup:["usergroup",!1],GetRoleCollectionFromUser:["usergroup",!1],GetRoleCollectionFromWeb:["usergroup",!1],GetRoleInfo:["usergroup",!1],GetRolesAndPermissionsForCurrentUser:["usergroup",!1],GetRolesAndPermissionsForSite:["usergroup",!1],GetUserCollection:["usergroup",!1],GetUserCollectionFromGroup:["usergroup",!1],GetUserCollectionFromRole:["usergroup",!1],GetUserCollectionFromSite:["usergroup",!1],GetUserCollectionFromWeb:["usergroup",!1],GetUserInfo:["usergroup",!1],GetUserLoginFromEmail:["usergroup",!1],RemoveGroup:["usergroup",!0],RemoveGroupFromRole:["usergroup",!0],RemoveRole:["usergroup",!0],RemoveUserCollectionFromGroup:["usergroup",!0],RemoveUserCollectionFromRole:["usergroup",!0],RemoveUserCollectionFromSite:["usergroup",!0],RemoveUserFromGroup:["usergroup",!0],RemoveUserFromRole:["usergroup",!0],RemoveUserFromSite:["usergroup",!0],RemoveUserFromWeb:["usergroup",!0],UpdateGroupInfo:["usergroup",!0],UpdateRoleDefInfo:["usergroup",!0],UpdateRoleInfo:["usergroup",!0],UpdateUserInfo:["usergroup",!0],AddColleague:["UserProfileService",!0],AddLink:["UserProfileService",!0],AddMembership:["UserProfileService",!0],AddPinnedLink:["UserProfileService",!0],CreateMemberGroup:["UserProfileService",!0],CreateUserProfileByAccountName:["UserProfileService",!0],GetCommonColleagues:["UserProfileService",!1],GetCommonManager:["UserProfileService",!1],GetCommonMemberships:["UserProfileService",!1],GetInCommon:["UserProfileService",!1],GetPropertyChoiceList:["UserProfileService",!1],GetUserColleagues:["UserProfileService",!1],GetUserLinks:["UserProfileService",!1],GetUserMemberships:["UserProfileService",!1],GetUserPinnedLinks:["UserProfileService",!1],GetUserProfileByGuid:["UserProfileService",!1],GetUserProfileByIndex:["UserProfileService",!1],GetUserProfileByName:["UserProfileService",!1],GetUserProfileCount:["UserProfileService",!1],GetUserProfileSchema:["UserProfileService",!1],GetUserPropertyByAccountName:["UserProfileService",!1],ModifyUserPropertyByAccountName:["UserProfileService",!0],RemoveAllColleagues:["UserProfileService",!0],RemoveAllLinks:["UserProfileService",!0],RemoveAllMemberships:["UserProfileService",!0],RemoveAllPinnedLinks:["UserProfileService",!0],RemoveColleague:["UserProfileService",!0],RemoveLink:["UserProfileService",!0],RemoveMembership:["UserProfileService",!0],RemovePinnedLink:["UserProfileService",!0],UpdateColleaguePrivacy:["UserProfileService",!0],UpdateLink:["UserProfileService",!0],UpdateMembershipPrivacy:["UserProfileService",!0],UpdatePinnedLink:["UserProfileService",!0],DeleteAllVersions:["Versions",!0],DeleteVersion:["Versions",!0],GetVersions:["Versions",!1],RestoreVersion:["Versions",!0],AddView:["Views",!0],DeleteView:["Views",!0],GetView:["Views",!1],GetViewHtml:["Views",!1],GetViewCollection:["Views",!1],UpdateView:["Views",!0],UpdateViewHtml:["Views",!0],AddWebPart:["WebPartPages",!0],AddWebPartToZone:["WebPartPages",!0],GetWebPart2:["WebPartPages",!1],GetWebPartPage:["WebPartPages",!1],GetWebPartProperties:["WebPartPages",!1],GetWebPartProperties2:["WebPartPages",!1],GetColumns:["Webs",!1],GetContentType:["Webs",!1],GetContentTypes:["Webs",!1],GetCustomizedPageStatus:["Webs",!1],GetListTemplates:["Webs",!1],GetObjectIdFromUrl:["Webs",!1],GetWeb:["Webs",!1],GetWebCollection:["Webs",!1],GetAllSubWebCollection:["Webs",!1],UpdateColumns:["Webs",!0],WebUrlFromPageUrl:["Webs",!1],AlterToDo:["Workflow",!0],ClaimReleaseTask:["Workflow",!0],GetTemplatesForItem:["Workflow",!1],GetToDosForItem:["Workflow",!1],GetWorkflowDataForItem:["Workflow",!1],GetWorkflowTaskData:["Workflow",!1],StartWorkflow:["Workflow",!0]}),function(){angular.module("angularPoint").constant("apXMLFieldAttributeTypes",{Decimals:"Number",EnforceUniqueValues:"Boolean",Filterable:"Boolean",FromBaseType:"Boolean",Hidden:"Boolean",Indexed:"Boolean",NumLines:"Number",ReadOnly:"Boolean",Required:"Boolean",Sortable:"Boolean"})}(),function(){angular.module("angularPoint").constant("apXMLListAttributeTypes",{BaseType:"Number",ServerTemplate:"Number",Created:"DateTime",Modified:"DateTime",LastDeleted:"DateTime",Version:"Number",ThumbnailSize:"Number",WebImageWidth:"Number",WebImageHeight:"Number",Flags:"Number",ItemCount:"Number",ReadSecurity:"Number",WriteSecurity:"Number",Author:"Number",MajorWithMinorVersionsLimit:"Number",HasUniqueScopes:"Boolean",NoThrottleListOperations:"Boolean",HasRelatedLists:"Boolean",AllowDeletion:"Boolean",AllowMultiResponses:"Boolean",EnableAttachments:"Boolean",EnableModeration:"Boolean",EnableVersioning:"Boolean",HasExternalDataSource:"Boolean",Hidden:"Boolean",MultipleDataList:"Boolean",Ordered:"Boolean",ShowUser:"Boolean",EnablePeopleSelector:"Boolean",EnableResourceSelector:"Boolean",EnableMinorVersion:"Boolean",RequireCheckout:"Boolean",ThrottleListOperations:"Boolean",ExcludeFromOfflineClient:"Boolean",EnableFolderCreation:"Boolean",IrmEnabled:"Boolean",IsApplicationList:"Boolean",PreserveEmptyValues:"Boolean",StrictTypeCoercion:"Boolean",EnforceDataValidation:"Boolean",MaxItemsPerThrottledOperation:"Number"})}(),angular.module("angularPoint").service("apUserModel",["$q","_","apDataService",function(e,t,r){function a(e){return(!s||e)&&(s=r.getUserProfileByName()),s}function i(t){if(!n||t){var i=e.defer();a(t).then(function(e){r.getGroupCollectionFromUser(e.userLoginName).then(function(e){i.resolve(e)})}),n=i.promise}return n}function o(r,a){var i=e.defer(),o=this;return l.getGroupCollection(a).then(function(e){o.groupMap&&o.groupMap.length===e.length||(o.groupMap=[],t.each(e,function(e){o.groupMap.push(e.Name)})),i.resolve(t.isObject(e[o.groupMap.indexOf(r)]))}),i.promise}var n,s,l={checkIfMember:o,getGroupCollection:i,getUserProfile:a};return l}]),angular.module("angularPoint").factory("apCamlFactory",["_",function(e){function t(e,t){var r;switch(e.objectType){case"HTML":case"JSON":r='<Contains><FieldRef Name="'+e.staticName+'" /><Value Type="Text"><![CDATA['+t+"]]></Value></Contains>";break;default:r='<Contains><FieldRef Name="'+e.staticName+'" /><Value Type="Text">'+t+"</Value></Contains>"}return r}function r(t,r){var a="",i="";return e.each(t,function(e,o){o<t.length-1&&(a+="<"+r+">",i="</"+r+">"+i),a+=e}),a+i}function a(a,i){var o=[];return e.each(a,function(e){o.push(t(e,i))}),r(o,"And")}return{camlContainsQuery:a,chainCamlSelects:r,createCamlContainsSelector:t}}]),function(){function e(e,t,r){function a(t){var a=this,i={readOnly:!1,objectType:"Text"};e.extend(a,i,t),a.displayName=a.displayName?a.displayName:r.fromCamelCase(a.mappedName),a.staticName=a.staticName||a.internalName}var i={Field:a};return a.prototype.getDefinition=function(){return t.getDefinition(this.objectType)},a.prototype.getDefaultValueForType=function(){return t.getDefaultValueForType(this.objectType)},a.prototype.getMockData=function(e){return t.getMockData(this.objectType,e)},i}angular.module("angularPoint").factory("apFieldFactory",e),e.$inject=["_","apFieldService","apUtilityService"]}(),angular.module("angularPoint").factory("apIndexedCacheFactory",["_",function(e){function t(t){var r=this;t&&e.extend(r,t)}function r(t){var r=this;if(!e.isObject(t)||!t.id)throw new Error("A valid entity wasn't found: ",t);r[t.id]||(r[t.id]=t)}function a(){var t=this;e.each(t,function(e,r){delete t[r]})}function i(){var t=this;return e.keys(t)}function o(e){var t=this,r=t.keys();return t[r[e]]}function n(){var e=this;return e.nthEntity(0)}function s(){var e=this,t=e.keys();return e[t[t.length-1]]}function l(){var e=this;return e.keys().length}function c(t){var r=this;e.isObject&&t.id&&r[t.id]?delete r[t.id]:e.isNumber(t)&&delete r[t]}function u(){var t=this;return e.toArray(t)}function m(){return new t}return t.prototype={addEntity:r,clear:a,count:l,first:n,keys:i,last:s,nthEntity:o,removeEntity:c,toArray:u},{create:m,IndexedCache:t}}]),angular.module("angularPoint").factory("apListFactory",["_","apConfig","apDefaultFields","apFieldFactory",function(e,t,r,a){function i(r){var a=this,i={viewFields:"",customFields:[],isReady:!1,fields:[],guid:"",mapping:{},title:"",webURL:t.defaultUrl};e.extend(a,i,r),a.environments=a.environments||{production:a.guid},s(a)}function o(){var r=this;if(e.isString(r.environments[t.environment]))return r.environments[t.environment];throw new Error("There isn't a valid environment definition for apConfig.environment="+t.environment+'  Please confirm that the list "'+r.title+'" has the necessary environmental configuration.')}function n(){var e=this;return e.WebFullUrl?e.WebFullUrl:e.webURL}function s(t){var i=function(e){var r=new a.Field(e);t.fields.push(r),t.viewFields+='<FieldRef Name="'+r.staticName+'"/>',t.mapping["ows_"+r.staticName]={mappedName:r.mappedName,objectType:r.objectType}};t.viewFields+="<ViewFields>",e.each(r,function(e){i(e)}),e.each(t.customFields,function(e){i(e)}),t.viewFields+="</ViewFields>"}i.prototype.getListId=o,i.prototype.identifyWebURL=n;var l=function(e){return new i(e)};return{create:l,List:i}}]),angular.module("angularPoint").factory("apListItemFactory",["$q","_","apCacheService","apDataService","apEncodeService","apUtilityService","apFormattedFieldValueService","apConfig",function(e,t,r,a,i,o,n,s){function l(){}function c(t){var r=this,i=r.getModel(),n=e.defer();return r.id?(a.updateListItem(i,r,t).then(function(e){n.resolve(e),o.registerChange(i)}),n.promise):i.addNewItem(r,t)}function u(r,n){var s=this,l=s.getModel(),c=e.defer(),u=[],m=t.isString(r)?[r]:r;t.each(m,function(e){var r=t.findWhere(l.list.customFields,{mappedName:e});r&&u.push(r)});var d=i.generateValuePairs(u,s),p={buildValuePairs:!1,valuePairs:d},f=t.extend({},p,n);return a.updateListItem(l,s,f).then(function(e){c.resolve(e),o.registerChange(l)}),c.promise}function m(t){var r=this,i=r.getModel(),n=e.defer();return a.deleteListItem(i,r,t).then(function(e){n.resolve(e),o.registerChange(i)}),n.promise}function d(e,a){var i=this;if(t.isUndefined(e))throw new Error("A field name is required.",e);if(t.isEmpty(i[e]))return"";var o=i.getModel(),n=o.getFieldDefinition(e);if(n&&n.List){var s=a||i[e].lookupId;return r.getCachedEntity(n.List,s)}throw new Error("This isn't a valid Lookup field or the field definitions need to be extended before we can complete this request.",e,a)}function p(e,t){var r=this,a=r.getFieldDefinition(e);if(!a)throw"A field definition for a field named "+e+" wasn't found.";return n.getFormattedFieldValue(r[e],a.objectType,t)}function f(e){var t=this,r=t.getModel();return r.validateEntity(t,e)}function g(e){var t=this;return t.getModel().getFieldDefinition(e)}function v(e){var t=this,r=t.getFieldDefinition(e);return r.label||r.DisplayName||r.displayName}function h(e){var t=this,r=t.getFieldDefinition(e);return r.description||r.Description||""}function b(e){var t=this,r=t.getFieldDefinition(e);return r.choices||r.Choices||[]}function y(){var e=this;return a.getAvailableWorkflows(e.fileRef.lookupValue)}function k(r){function i(){a.startWorkflow(r).then(function(e){n.resolve(e)})}var o=this,n=e.defer();if(r.fileRef=o.fileRef.lookupValue,!r.templateId&&!r.workflowName)throw"Either a templateId or workflowName is required to initiate a workflow.";return r.templateId?i():o.getAvailableWorkflows().then(function(e){var a=t.findWhere(e,{name:r.workflowName});if(!a)throw"A workflow with the specified name wasn't found.";r.templateId=a.templateId,i()}),n.promise}function S(){var e=this;return a.getCollection({operation:"GetAttachmentCollection",listName:e.getModel().list.getListId(),webURL:e.getModel().list.webURL,ID:e.id,filterNode:"Attachment"})}function C(e){var t=this;return a.deleteAttachment({listItemID:t.id,url:e,listName:t.getModel().list.getListId()})}function U(){var e=this;return o.resolvePermissions(e.permMask)}function N(r){var i=e.defer(),o=[],n=this,l=n.getModel(),c=function(e){var r=t.findWhere(l.list.fields,{mappedName:e}),i={operation:"GetVersionCollection",strlistID:l.list.getListId(),strlistItemID:n.id,strFieldName:r.staticName};s.defaultUrl&&(i.webURL=s.defaultUrl),o.push(a.getFieldVersionHistory(i,r))};if(r)t.isString(r)&&(r=[r]);else{var u=t.where(l.list.fields,{readOnly:!1});r=[],t.each(u,function(e){r.push(e.mappedName)})}return t.each(r,function(e){c(e)}),e.all(o).then(function(e){var r={};t.each(e,function(e){t.each(e,function(e){r[e.modified.toJSON()]=r[e.modified.toJSON()]||{},t.extend(r[e.modified.toJSON()],e)})});var a=[];t.each(r,function(e,t){e.version=t,a.push(e)}),i.resolve(a)}),i.promise}l.prototype={constructor:l,deleteAttachment:C,deleteItem:m,getAttachmentCollection:S,getAvailableWorkflows:y,getFieldChoices:b,getFieldDefinition:g,getFieldDescription:h,getFieldLabel:v,getFieldVersionHistory:N,getFormattedValue:p,getLookupReference:d,resolvePermissions:U,saveChanges:c,saveFields:u,startWorkflow:k,validateEntity:f};var L=function(e){var r=this;t.extend(r,e)},w=function(){return new l},I=function(){return new L};return{create:w,createGenericFactory:I,ListItem:l,StandardListItem:L}}]),angular.module("angularPoint").factory("apLookupFactory",["_","$q","apUtilityService",function(e,t,r){function a(e){var t=this,a=new r.SplitIndex(e);t.lookupId=a.id,t.lookupValue=a.value||""}var i=function(e,t){return new a(e,t)};return{create:i,Lookup:a}}]),angular.module("angularPoint").factory("apModelFactory",["_","apCacheService","apDataService","apListFactory","apListItemFactory","apQueryFactory","apUtilityService","apFieldService","apConfig","apIndexedCacheFactory","apDecodeService","$q","toastr",function(e,t,r,a,i,o,n,s,l,c,u,m,d){function p(r){var o=this,n={data:[],factory:i.createGenericFactory(),fieldDefinitionsExtended:!1,lastServerUpdate:null,queries:{},requestForFieldDefinitions:null};return e.extend(o,n,r),o.list=a.create(o.list),o.factory.prototype=i.create(),o.factory.constructor=i.ListItem,o.factory.prototype.getModel=function(){return o},o.factory.prototype.getList=function(){return o.list},o.factory.prototype.getListId=function(){return o.list.getListId()},t.registerModel(o),o.registerQuery({name:"getAllListItems",operation:"GetListItems"}),o.searchLocalCache=f,o}function f(t,r){var a,i,o,n=this,s={propertyPath:"id",localCache:n.getCache(),cacheName:"main",rebuildIndex:!1},l=e.extend({},s,r);if("id"===l.propertyPath)i=l.localCache;else{n._cachedIndexes=n._cachedIndexes||{},n._cachedIndexes[l.cacheName]=n._cachedIndexes[l.cacheName]||{},a=n._cachedIndexes[l.cacheName];var c=l.propertyPath.split(".");e.each(c,function(e){a[e]=a[e]||{},a=a[e]}),(!e.isNumber(a.count)||a.count!==l.localCache.count()||l.rebuildIndex)&&(a.indexedCache=g(l.localCache,l.propertyPath),a.count=l.localCache.count(),a.buildCount=a.buildCount||0,a.buildCount++),i=a.indexedCache}return e.isArray(t)?(o=[],e.each(t,function(e){o.push(i[e])})):o=i[t],o}function g(t,r){function a(){}function i(t){var a=this,i=e.deepGet(t,r);i&&(a[i]=t)}a.prototype=c.IndexedCache,a.prototype.addEntity=i;var o=new a;return e.each(t,function(e){o.addEntity(e)}),o}function v(){var e=this;return r.executeQuery(e,e.queries.getAllListItems)}function h(t,r){var a=m.defer(),i=this,o="GetListItemById-"+t;if(!i.getQuery(o)){var n={name:o,operation:"GetListItems",CAMLRowLimit:1,CAMLQuery:'<Query> <Where>   <Eq>     <FieldRef Name="ID"/>     <Value Type="Number">'+t+"</Value>   </Eq> </Where></Query>"},s=e.extend({},n,r);i.registerQuery(s)}return i.executeQuery(o).then(function(e){a.resolve(e.first())},function(e){a.reject(e)}),a.promise}function b(e,t){var a=this,i=m.defer();return r.createListItem(a,e,t).then(function(e){i.resolve(e),n.registerChange(a)}),i.promise}function y(t){var r=this,a={name:A};return t=e.extend({},a,t),r.queries[t.name]=o.create(t,r),r.queries[t.name]}function k(t){var r,a=this;return r=e.isObject(a.queries[t])?a.queries[t]:e.isObject(a.queries[A])&&!t?a.queries[A]:void 0}function S(t){var r=this;return e.findWhere(r.list.fields,{mappedName:t})}function C(e){var t,r,a=this;return t=a.getQuery(e),t&&t.indexedCache&&(r=t.indexedCache),r}function U(e){var r=this;return t.getCachedEntity(r.list.getListId(),e)}function N(){var e=this;return t.getCachedEntities(e.list.getListId())}function L(e,t){var r=this,a=r.getQuery(e);return a?a.execute(t):void 0}function w(t){var a=this,i=m.defer(),o={listName:a.list.getListId()};if(!a.deferredListDefinition){a.deferredListDefinition=i.promise;var n=e.extend({},o,t);r.getList(n).then(function(e){u.extendListMetadata(a,e),i.resolve(a)})}return a.deferredListDefinition}function I(){var t=this;return e.isDate(t.lastServerUpdate)}function P(t){var r=this,a={};e.each(r.list.customFields,function(e){e.readOnly||(a[e.mappedName]=s.getDefaultValueForType(e.objectType))});var i=e.extend({},a,t);return new r.factory(i)}function F(t){var r=[],a=this,i={quantity:10,staticValue:!1,permissionLevel:"FullMask"},o=e.extend({},i,t);return e.times(o.quantity,function(t){var i={};e.each(a.list.fields,function(e){i[e.mappedName]=e.getMockData(o)}),i.id=t+1,r.push(new a.factory(i))}),r}function T(t,r){var a=!0,i=this,o={toast:!0},n=e.extend({},o,r),s=function(t){return e.isObject(t)&&e.isNumber(t.lookupId)};return e.each(i.list.customFields,function(r){var i=t[r.mappedName],o='"'+r.objectType+'" value.';if((r.required||r.Required)&&a){switch(r.objectType){case"Boolean":a=e.isBoolean(i);break;case"DateTime":a=e.isDate(i);break;case"Lookup":case"User":a=s(i);break;case"LookupMulti":case"UserMulti":a=e.isArray(i)&&i.length>0,a&&e.each(i,function(e){return a?void(a=s(e)):!1});break;default:a=!e.isEmpty(i)}if(!a&&n.toast){var l=r.label||r.staticName;d.error(l+" does not appear to be a valid "+o)}}return a?void 0:!1}),a}function G(){var e=this;if(e.list&&e.list.effectivePermMask){var t=n.convertEffectivePermMask(e.list.effectivePermMask);return n.resolvePermissions(t)}return window.console.error("Attempted to resolve permissions of a model that hasn't been initialized.",e),n.resolvePermissions(null)}function D(e){return new p(e)}var A=l.defaultQueryName;return p.prototype={addNewItem:b,createEmptyItem:P,executeQuery:L,extendListMetadata:w,generateMockData:F,getAllListItems:v,getCache:C,getCachedEntity:U,getCachedEntities:N,getFieldDefinition:S,getListItemById:h,getQuery:k,isInitialised:I,resolvePermissions:G,registerQuery:y,validateEntity:T},{create:D,deepGroup:g,Model:p,searchLocalCache:f}}]),angular.module("angularPoint").factory("apQueryFactory",["_","apCacheService","apIndexedCacheFactory","apDataService","apConfig","$q","apDefaultListItemQueryOptions",function(e,t,r,a,i,o,n){function s(t,a){var s=this,l={changeToken:void 0,initialized:o.defer(),indexedCache:r.create(),lastRun:null,listName:a.list.getListId(),negotiatingWithServer:!1,operation:"GetListItemChangesSinceToken",cacheXML:!1,query:'<Query>   <OrderBy>       <FieldRef Name="ID" Ascending="TRUE"/>   </OrderBy></Query>',queryOptions:n,viewFields:a.list.viewFields};i.defaultUrl&&(l.webURL=i.defaultUrl),e.extend(s,l,t),s.getModel=function(){return a},s.getCache=c}function l(t){var r=this,i=r.getModel(),n=o.defer();if(r.negotiatingWithServer||e.isDate(r.lastRun)&&r.lastRun.getTime()+100>(new Date).getTime())return r.promise;r.negotiatingWithServer=!0;var s=e.isNull(r.lastRun),l={target:r.getCache()},c=e.extend({},l,t);return a.executeQuery(i,r,c).then(function(){s&&r.initialized.resolve(c.target),r.negotiatingWithServer=!1,i.lastServerUpdate=new Date,n.resolve(c.target)}),r.promise=n.promise,n.promise}function c(){var e=this;return e.indexedCache}function u(t,r){var a=this,i=a.getModel(),o={cacheName:a.name,localCache:a.getCache()},n=e.extend({},o,r);return i.searchLocalCache(t,n)}function m(e,t){return new s(e,t)}return s.prototype={execute:l,searchLocalCache:u},{create:m,Query:s}}]),angular.module("angularPoint").factory("apUserFactory",["apUtilityService",function(e){function t(t){var r=this,a=new e.SplitIndex(t),i=a.value.split(",#");1===i.length?(r.lookupId=a.id,r.lookupValue=a.value):(r.lookupId=a.id,r.lookupValue=i[0].replace(/(,,)/g,","),r.loginName=i[1].replace(/(,,)/g,","),r.email=i[2].replace(/(,,)/g,","),r.sipAddress=i[3].replace(/(,,)/g,","),r.title=i[4].replace(/(,,)/g,","))}var r=function(e){return new t(e)};return{create:r,User:t}}]),angular.module("angularPoint").factory("apCacheService",["$q","$log","_","apIndexedCacheFactory",function(e,t,r,a){function i(){}function o(e,t){var r=this;r.associationQueue=[],r.updateCount=0,r.listId=c(e),r.entityId=t,r.entityLocations=[]}function n(e){if(e.list&&e.list.getListId()&&e.list.title){var t=e.list.getListId().toLowerCase();k[e.list.title]={model:e,listId:t},S[t]={model:e}}}function s(e){var t,r=c(e);return S[r]&&(t=S[r].model),t}function l(e){var t;return k[e]&&k[e].listId&&(t=k[e].listId),t}function c(e){return r.isGuid(e)?e.toLowerCase():l(e)}function u(){var t=this,r=e.defer();return t.entity?r.resolve(t.entity):t.associationQueue.push(r),r.promise}function m(e,t){return y(e,t).entity}function d(e){var t=b(e),i=a.create();return r.each(t,function(e){e.entity&&e.entity.id&&i.addEntity(e.entity)}),i}function p(e,t){var r=y(e,t);return r.getEntity()}function f(e,t){var a=e.getModel(),i=y(a.list.getListId(),e.id);return r.isObject(i.entity)?r.extend(i.entity,e):i.entity=e,i.updateCount++,r.isObject(t)&&!r.isArray(t)&&(t[e.id]=e),r.each(i.associationQueue,function(t){t.resolve(e),i.associationQueue.shift()}),i.entity}function g(){var e=this;v(e.listId,e.entityId)}function v(e,t){var r=b(e,t);r[t]&&delete r[t]}function h(e,t){var a=c(e);v(a,t);var i=s(a);r.each(i.queries,function(e){var r=e.getCache();r.removeEntity(t)})}function b(e){var t=c(e);return C[t]=C[t]||new i,C[t]}function y(e,t){var r=c(e),a=b(r);return a[t]=a[t]||new o(r,t),a[t]}var k={},S={},C={};return i.prototype=a.create(),i.constructor=i,o.prototype={getEntity:u,removeEntity:g},{deleteEntity:h,entityCache:C,getCachedEntity:m,getCachedEntities:d,getEntity:p,getEntityContainer:y,getListIdFromListName:l,getListId:c,getModel:s,removeEntity:v,registerEntity:f,registerModel:n}}]),angular.module("angularPoint").factory("apDataService",["$q","$timeout","$http","_","apConfig","apUtilityService","apCacheService","apDecodeService","apEncodeService","apFieldService","apIndexedCacheFactory","toastr","SPServices","apDefaultListItemQueryOptions","apWebServiceOperationConstants","apXMLToJSONService",function(e,t,r,a,i,o,n,s,l,c,u,m,d,p,f,g){function v(t){var i=e.defer(),o=d.generateXMLComponents(t),n=f[t.operation][0];return U(n,t.webURL).then(function(e){r({method:"POST",url:e,data:o.msg,responseType:"document",headers:{"Content-Type":"text/xml;charset='utf-8'"},transformRequest:function(e,t){if(o.SOAPAction){var r=t();r.SOAPAction=o.SOAPAction}return e},transformResponse:function(e){return a.isString(e)&&(e=$.parseXML(e)),e}}).then(function(e){var r=s.checkResponseForErrors(e.data);r?(console.error(r,t),i.reject(r)):i.resolve(e.data)},function(e){var r=s.checkResponseForErrors(e.data);console.error(e.statusText,t),i.reject(e.statusText+": "+r)})}),i.promise}function h(t){function r(e){if(n.filterNode){var t=$(e).SPFilterNode(n.filterNode);return g(t,{includeAllAttrs:!0,removeOws:!1})}return e}var o={postProcess:r,webURL:i.defaultUrl},n=a.extend({},o,t),s=e.defer();return W.requestData(n).then(function(e){var t=n.postProcess(e);s.resolve(t)},function(e){m.error("Failed to complete the requested "+n.operation+" operation."),s.reject(e)}),s.promise}function b(t,r){var i={operation:"GetVersionCollection"},o=a.extend({},i,t),n=e.defer();return h(o).then(function(e){var t=s.parseFieldVersions(e,r);n.resolve(t)},function(e){m.error("Failed to fetch version history."),n.reject(e)}),n.promise}function y(t){function r(e){var t=[];if("GetAttachmentCollection"===o.operation)$(e).SPFilterNode(n).each(function(){t.push($(this).text())});else{var r=$(e).SPFilterNode(n);t=g(r,{includeAllAttrs:!0,removeOws:!1})}return t}var i={postProcess:r},o=a.extend({},i,t),n=o.filterNode||o.operation.split("Get")[1].split("Collection")[0],s=e.defer(),l=k(o);return l?h(o).then(function(e){s.resolve(e)}):(m.error("Invalid payload:",o),s.reject()),s.promise}function k(e){var t=!0,r=function(r){a.each(r,function(r){e[r]||(m.error("options"+r+" is required to complete this operation"),t=!1)})};switch(e.operation){case"GetGroupCollectionFromUser":r(["userLoginName"]);break;case"GetUserCollectionFromGroup":r(["groupName"]);break;case"GetViewCollection":r(["listName"]);break;case"GetAttachmentCollection":r(["listName","ID"])}return t}function S(t){var r=e.defer(),a={operation:"GetUserProfileByName"};return t&&(a.accountName=t),h(a).then(function(e){var t={};$(e).SPFilterNode("PropertyData").each(function(){var e=$(this).SPFilterNode("Name"),r=$(this).SPFilterNode("Value");e.length>0&&r.length>0&&(t[e.text().trim()]=r.text().trim())}),t.userLoginName=i.userLoginNamePrefix?i.userLoginNamePrefix+t.AccountName:t.AccountName,r.resolve(t)}),r.promise}function C(t){function r(e){W.serviceWrapper({operation:"GetGroupCollectionFromUser",userLoginName:e,filterNode:"Group"}).then(function(e){a.resolve(e)})}var a=e.defer();return t?r(t):S().then(function(e){r(e.userLoginName)}),a.promise}function U(t,r){var a="_vti_bin/"+t+".asmx",i=e.defer();return r?(a="/"===r.charAt(r.length-1)?r+a:r+"/"+a,i.resolve(a)):N().then(function(e){a=e+("/"===e.charAt(e.length-1)?a:"/"+a),i.resolve(a)}),i.promise}function N(){var t=e.defer(),a=N;if(!a.query){a.query=t.promise;var o=d.SOAPEnvelope.header+"<WebUrlFromPageUrl xmlns='"+d.SCHEMASharePoint+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+d.SOAPEnvelope.footer;r({method:"POST",url:"/_vti_bin/Webs.asmx",data:o,responseType:"document",headers:{"Content-Type":"text/xml;charset='utf-8'"}}).then(function(e){i.defaultUrl=$(e.data).find("WebUrlFromPageUrlResult").text(),t.resolve(i.defaultUrl)
},function(e){var r=s.checkResponseForErrors(e.data);t.reject(r)})}return a.query}function L(e){var t={operation:"GetList"},r=a.extend({},t,e);return h(r)}function w(t){var r=e.defer();return L(t).then(function(e){var t=$(e).SPFilterNode("Field"),a=g(t,{includeAllAttrs:!0,removeOws:!1});r.resolve(a)}),r.promise}function I(e){var t={operation:"DeleteAttachment",filterNode:"Field"},r=a.extend({},t,e);return h(r)}function P(t,r,i){var o={target:t.getCache()},n=e.defer(),l=a.extend({},o,i);return h(r).then(function(e){"GetListItemChangesSinceToken"===r.operation&&F(t,r,e,l);var a=s.processListItems(t,r,e,l);n.resolve(a),r.lastRun=new Date}),n.promise}function F(e,t,r,a){e.deferredListDefinition||(e.deferredListDefinition=t.initialized.promise,s.extendListMetadata(e,r)),t.changeToken=T(r);var i=G(r);i&&(e.list.effectivePermMask=i),D(r,a.target)}function T(e){return $(e).find("Changes").attr("LastChangeToken")}function G(e){return $(e).find("listitems").attr("EffectivePermMask")}function D(e,t){$(e).SPFilterNode("Id").each(function(){var e=$(this).attr("ChangeType");if("Delete"===e){var r=parseInt($(this).text(),10);t.removeEntity(r)}})}function A(t,r,i){var o={batchCmd:"New",buildValuePairs:!0,indexedCache:u.create({}),listName:t.list.getListId(),operation:"UpdateListItems",valuePairs:[],webURL:t.list.identifyWebURL()},n=e.defer();o.target=o.indexedCache;var c=a.extend({},o,i);if(c.buildValuePairs===!0){var m=a.where(t.list.fields,{readOnly:!1});c.valuePairs=l.generateValuePairs(m,r)}return c.getCache=function(){return c.indexedCache},h(c,r,t).then(function(e){var r=s.processListItems(t,c,e,c);n.resolve(r.last())},function(e){n.reject(e)}),n.promise}function M(t,r,i){var o={batchCmd:"Update",buildValuePairs:!0,ID:r.id,listName:t.list.getListId(),operation:"UpdateListItems",target:r.getCache(),valuePairs:[],webURL:t.list.identifyWebURL()},n=e.defer(),c=a.extend({},o,i);if(c.buildValuePairs===!0){var u=a.where(t.list.fields,{readOnly:!1});c.valuePairs=l.generateValuePairs(u,r)}return t.list.webURL&&!c.webURL&&(c.webURL=t.list.webURL),h(c,r,t).then(function(e){var a=s.processListItems(t,r.getQuery(),e,c);n.resolve(a[r.id])},function(e){n.reject(e)}),n.promise}function x(t,r,i){var o={target:a.isFunction(r.getCache)?r.getCache():t.getCache(),operation:"UpdateListItems",listName:t.list.getListId(),batchCmd:"Delete",ID:r.id,webURL:t.list.identifyWebURL()},s=a.extend({},o,i),l=e.defer();return h(s).then(function(){n.deleteEntity(s.listName,r.id),l.resolve()},function(e){m.error("There was an error deleting a list item from "+t.list.title),l.reject(e)}),l.promise}function R(e){return window.location.protocol+"//"+window.location.hostname+"/"+e}function V(t){var r=e.defer(),i=t.indexOf("://")>-1?t:R(t);return h({operation:"GetTemplatesForItem",item:i}).then(function(e){var t=[],i=$(e).SPFilterNode("WorkflowTemplate");a.each(i,function(e){var r={name:$(e).attr("Name"),instantiationUrl:$(e).attr("InstantiationUrl"),templateId:"{"+$(e).find("WorkflowTemplateIdSet").attr("TemplateId")+"}"};t.push(r)}),r.resolve(t)}),r.promise}function O(e){var t={operation:"StartWorkflow",item:"",fileRef:"",templateId:"",workflowParameters:"<root />"},r=a.extend({},t,e);return!r.item&&r.fileRef&&(r.item=R(r.fileRef)),h(r)}var W={createListItem:A,deleteAttachment:I,deleteListItem:x,executeQuery:P,generateWebServiceUrl:U,getAvailableWorkflows:V,getCollection:y,getCurrentSite:N,getFieldVersionHistory:b,getGroupCollectionFromUser:C,getList:L,getListFields:w,getUserProfileByName:S,processChangeTokenXML:F,processDeletionsSinceToken:D,requestData:v,retrieveChangeToken:T,retrievePermMask:G,serviceWrapper:h,startWorkflow:O,updateListItem:M};return W}]),angular.module("angularPoint").factory("apDecodeService",["$q","_","apUtilityService","apConfig","apCacheService","apLookupFactory","apUserFactory","apFieldService","apXMLListAttributeTypes","apXMLFieldAttributeTypes",function(e,t,r,a,i,o,n,s,l,c){function u(e,r,a,i){var o={factory:e.factory,filter:"z:row",mapping:e.list.mapping,target:e.getCache()},n=t.extend({},o,i),s=$(a).SPFilterNode(n.filter),l=m(e,r,n.target);return d(s,l,n),n.target}function m(e,t,r){return function(a){a.getCache=function(){return r},a.getQuery=function(){return t};var o=new e.factory(a);return i.registerEntity(o,r)}}function d(e,r,a){var i={mapping:{},includeAllAttrs:!1,removeOws:!0},o=t.extend({},i,a),n=[];return t.each(e,function(e){var t=p(e,r,o);n.push(t)}),n}function p(e,r,a){var i={},o=e.attributes;return t.each(a.mapping,function(e){i[e.mappedName]=s.getDefaultValueForType(e.objectType)}),t.each(o,function(e){var t=e.name,r=a.mapping[t],o="undefined"!=typeof r?r.mappedName:a.removeOws?t.split("ows_")[1]:t,n="undefined"!=typeof r?r.objectType:void 0;(a.includeAllAttrs||void 0!==r)&&(i[o]=f(e.value,n,{entity:i,propertyName:o}))}),r(i)}function f(e,r,a){var i,o=t.unescape(e);switch(r){case"Attachments":i=g(o);break;case"Boolean":i=k(o);break;case"Calculated":i=I(o);break;case"datetime":case"DateTime":i=S(o);break;case"Lookup":i=N(o,a);break;case"User":i=C(o);break;case"LookupMulti":i=L(o,a);break;case"UserMulti":i=U(o);break;case"Integer":case"Counter":i=b(o);break;case"Number":case"Currency":case"float":case"Float":i=y(o);break;case"MultiChoice":i=w(o);break;case"JSON":i=v(o);break;case"Choice":case"HTML":case"Note":default:i=h(o)}return i}function g(e){if(isNaN(e))return w(e);var t=parseInt(e);return t>0?t:""}function v(e){if(e){var t=null;try{t=JSON.parse(e)}catch(r){console.error("Invalid JSON: ",e)}return t}return e}function h(e){return e}function b(e){return e?parseInt(e,10):e}function y(e){return e?parseFloat(e):e}function k(e){return"1"===e||"True"===e||"TRUE"===e}function S(e){if(e){var t=e.split(e.split("T")[0]!==e?"T":" "),r=t[0].split("-"),a=t[1].split(":"),i=a[2].split("Z");return new Date(r[0],r[1]-1,r[2],a[0],a[1],i[0])}return null}function C(e){return 0===e.length?null:n.create(e)}function U(e){if(0===e.length)return[];for(var t=[],r=e.split(";#"),a=0;a<r.length;a+=2){var i=C(r[a]+";#"+r[a+1]);t.push(i)}return t}function N(e,t){return 0===e.length?null:o.create(e,t)}function L(e,t){if(0===e.length)return[];for(var r=[],a=e.split(";#"),i=0;i<a.length;i+=2){var o=N(a[i]+";#"+a[i+1],t);r.push(o)}return r}function w(e){if(0===e.length)return[];for(var t=[],r=e.split(";#"),a=0;a<r.length;a++)0!==r[a].length&&t.push(r[a]);return t}function I(e){if(0===e.length)return null;var t=e.split(";#");return f(t[1],t[0])}function P(e,r,a){var i=r||{},o=a||{},n=e.attributes;return t.each(n,function(t,r){var a=n[r].name;i[a]=$(e).attr(a),o[a]&&(i[a]=f(i[a],o[a]))}),i}function F(e,t){T(e.list,t),G(e.list.fields,t)}function T(e,t){return $(t).find("List").each(function(){P(this,e,l)}),e}function G(e,r){var a={};t.each(e,function(e){e.staticName&&(a[e.staticName]=e)});var i=$(r).SPFilterNode("Field");return t.each(i,function(e){var r=$(e).attr("StaticName"),i=a[r];if(i&&(P(e,i,c),"Choice"===i.objectType||"MultiChoice"===i.objectType)){i.Choices=[];var o=$(e).find("CHOICE");t.each(o,function(e){i.Choices.push($(e).text())}),i.Default=$(e).find("Default").text()}}),e}function D(e){var t=new Date(e.getTime()+60*e.getTimezoneOffset()*1e3),r=e.getTimezoneOffset()/60,a=e.getHours();return t.setHours(a-r),t}function A(e,r){var a=[],i=$(e).find("Version"),o=i.length;return t.each(i,function(e,t){var i=f($(e).attr("Modified"),"DateTime"),n={editor:f($(e).attr("Editor"),"User"),modified:D(i),version:o-t};n[r.mappedName]=f($(e).attr(r.staticName),r.objectType),a.unshift(n)}),a}function M(e){var r=null,a=["ErrorText","errorstring"];return t.each(a,function(t){$(e).find(t).each(function(){return r=$(this).text(),!1})}),r}return{checkResponseForErrors:M,extendFieldDefinitionsFromXML:G,extendListDefinitionFromXML:T,extendListMetadata:F,jsBoolean:k,jsCalc:I,jsChoiceMulti:w,jsDate:S,jsFloat:y,jsInt:b,jsLookup:N,jsLookupMulti:L,jsObject:v,jsString:h,jsUser:C,jsUserMulti:U,parseFieldVersions:A,parseStringValue:f,processListItems:u,xmlToJson:d}}]),angular.module("angularPoint").factory("apEncodeService",["_","apConfig","apUtilityService","SPServices",function(e,t,r,a){function i(t){var r="",a=";#";return t.length>0&&(r+=a,e.each(t,function(e){r+=e+a})),r}function o(t,r){var a=[];return e.each(t,function(t){e.has(r,t.mappedName)&&a.push(n(t,r[t.mappedName]))}),a}function n(e,t){var r=s(e.objectType,t);return[e.staticName,r]}function s(t,r){var o="";if(""!==r&&!e.isUndefined(r)&&!e.isNull(r))switch(t){case"Lookup":case"User":r.lookupId&&(o=r.lookupId+";#"+(r.lookupValue||""));break;case"LookupMulti":case"UserMulti":o=c(r,"lookupId");break;case"MultiChoice":o=i(r);break;case"Boolean":o=r?1:0;break;case"DateTime":o=l(r);break;case"JSON":o=JSON.stringify(r);break;case"HTML":case"Note":default:o=r}return e.isString(o)&&(o=a.encodeXml(o)),o}function l(t){if(!e.isDate(t)&&e.isString(t)&&3===t.split("-").length){var a=t.split("-");t=new Date(a[0],a[1]-1,a[2],0,0,0)}else if(!e.isDate(t))throw new Error("Invalid Date Provided: "+value.toString());var i=l,o="";return o+=t.getFullYear(),o+="-",o+=r.doubleDigit(t.getMonth()+1),o+="-",o+=r.doubleDigit(t.getDate()),o+="T",o+=r.doubleDigit(t.getHours()),o+=":",o+=r.doubleDigit(t.getMinutes()),o+=":",o+=r.doubleDigit(t.getSeconds()),o+="Z-",i.timeZone||(i.timeZone=(new Date).getTimezoneOffset()/60),o+=r.doubleDigit(i.timeZone),o+=":00"}function c(t,r,a){var i="",o=r||"lookupId",n=a||"lookupValue";return e.each(t,function(e,r){i+=e[o]+";#"+(e[n]||""),r<t.length&&(i+=";#")}),i}return{choiceMultiToString:i,createValuePair:n,encodeValue:s,generateValuePairs:o,stringifySharePointDate:l,stringifySharePointMultiSelect:c}}]),angular.module("angularPoint").factory("apExportService",["_","apUtilityService","apFormattedFieldValueService",function(e,t,r){function a(e,t,r){if(!e)return void console.error("apExportService.save"+t.toUpperCase()+": No data");var a=t.split(";")[0];r||(r="debug."+a),"json"===t&&"object"==typeof e&&(e=JSON.stringify(e,void 0,4));var i=new Blob([e],{type:"text/"+t}),o=document.createEvent("MouseEvents"),n=document.createElement("a");n.download=r,n.href=window.URL.createObjectURL(i),n.dataset.downloadurl=["text/"+t,n.download,n.href].join(":"),o.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}function i(e,t){a(e,"json",t)}function o(e,t){a(e,"xml",t)}function n(e){var t=e;return t=t.replace(/[\u2018|\u2019|\u201A]/g,"'"),t=t.replace(/[\u201C|\u201D|\u201E]/g,'"'),t=t.replace(/\u2026/g,"..."),t=t.replace(/[\u2013|\u2014]/g,"-"),t=t.replace(/\u02C6/g,"^"),t=t.replace(/\u2039/g,"<"),t=t.replace(/\u203A/g,">"),t=t.replace(/[\u02DC|\u00A0]/g," ")}function s(t,r){var i="";e.each(t,function(t){e.each(t,function(e,t){var r=null===e?"":n(e);t>0&&(i+=","),r=r.replace(/"/g,'""'),i+='"'+r+'"'}),i+="\n"}),a(i,"csv;charset=utf-8;",r)}function l(a,i,o){var n={dateFormat:"json",delim:"; ",includeTitleRow:!0},s=e.extend({},n,o),l=[[]];return e.each(a,function(a,o){var n=[];e.each(i,function(i){var c=e.isString(i)?{field:i}:i,u=c.field.split("."),m=u[0];if(0===o&&s.includeTitleRow){var d=c.label?c.label:t.fromCamelCase(m);l[0].push(d)}var p="";if(e.isFunction(c.stringify))p=c.stringify(a[c.field]);else if(u.length>1)e.deepIn(a,c.field)&&(p=e.deepGet(a,c.field).toString());else{var f=a.getFieldDefinition(m);p=r.getFormattedFieldValue(a[c.field],f.objectType,s)}n.push(p)}),l.push(n)}),l}return{generateCSV:l,saveCSV:s,saveFile:a,saveJSON:i,saveXML:o}}]),angular.module("angularPoint").factory("apFieldService",["_",function(e){function t(){return{Text:{defaultValue:"",staticMock:"Test String",dynamicMock:o},Note:{defaultValue:"",staticMock:"This is a sentence.",dynamicMock:s},Boolean:{defaultValue:null,staticMock:!0,dynamicMock:a},Calculated:{defaultValue:null,staticMock:"float;#123.45",dynamicMock:i},Choice:{defaultValue:"",staticMock:"My Choice",dynamicMock:o},Counter:{defaultValue:null,staticMock:r(),dynamicMock:r},Currency:{defaultValue:null,staticMock:120.5,dynamicMock:l},DateTime:{defaultValue:null,staticMock:new Date(2014,5,4,11,33,25),dynamicMock:c},Integer:{defaultValue:null,staticMock:14,dynamicMock:u},JSON:{defaultValue:"",staticMock:[{id:1,title:"test"},{id:2}],dynamicMock:o},Lookup:{defaultValue:"",staticMock:{lookupId:49,lookupValue:"Static Lookup"},dynamicMock:p},LookupMulti:{defaultValue:[],staticMock:[{lookupId:50,lookupValue:"Static Multi 1"},{lookupId:51,lookupValue:"Static Multi 2"}],dynamicMock:g},Mask:{defaultValue:d(),staticMock:d(),dynamicMock:d},MultiChoice:{defaultValue:[],staticMock:["A Good Choice","A Bad Choice"],dynamicMock:n},User:{defaultValue:"",staticMock:{lookupId:52,lookupValue:"Static User"},dynamicMock:f},UserMulti:{defaultValue:[],staticMock:[{lookupId:53,lookupValue:"Static User 1"},{lookupId:54,lookupValue:"Static User 2"}],dynamicMock:v}}}function r(){return k++,k}function a(){return chance.bool()}function i(){return"float;#"+chance.floating({min:0,max:1e4})}function o(){return chance.word()+" "+chance.word()}function n(){var t=[];return e.times(e.random(1,4),function(){t.push(o())}),t}function s(){return chance.paragraph()}function l(){return parseInt(100*e.random(1e7,!0))/100}function c(){return chance.date()}function u(){return chance.integer()}function m(e){var t;switch(e){case"AddListItems":t="0x0000000000000002";break;case"EditListItems":t="0x0000000000000004";break;case"DeleteListItems":t="0x0000000000000008";break;case"ApproveItems":t="0x0000000000000010";break;case"FullMask":t="0x7FFFFFFFFFFFFFFF";break;case"ViewListItems":default:t="0x0000000000000001"}return t}function d(e){var t="FullMask";return e&&e.permissionLevel&&(t=e.permissionLevel),m(t)}function p(){return{lookupId:r(),lookupValue:chance.word()}}function f(){return{lookupId:r(),lookupValue:chance.name()}}function g(){var t=[];return e.each(e.random(10),function(){t.push(p())}),t}function v(){var t=[];return e.each(e.random(10),function(){t.push(f())}),t}function h(e){var r=t();return r[e]?r[e]:r.Text}function b(e){var t,r=h(e);return r&&(t=r.defaultValue),t}function y(t,r){var a,i=h(t);return i&&(a=e.isFunction(Chance)&&r&&!r.staticValue?i.dynamicMock(r):i.staticMock),a}var k=0;return{getDefaultValueForType:b,getMockData:y,getDefinition:h,mockPermMask:d,resolveValueForEffectivePermMask:m}}]),function(){function e(e){function t(e,t,u){var m={delim:", ",dateFormat:"short"},d=_.extend({},m,u),p="";if(e)switch(t){case"Boolean":p=n(e);break;case"Calculated":p=r(e);break;case"Lookup":case"User":p=o(e);break;case"DateTime":p=s(e,d.dateFormat);break;case"Integer":case"Number":case"Float":case"Counter":p=a(e);break;case"Currency":p=i(e);break;case"MultiChoice":p=l(e,d.delim);break;case"UserMulti":case"LookupMulti":p=c(e,d.delim);break;default:p=e}return p}function r(e){return 0===e.length?"":_.isNumber(e)?t(e,"Number"):_.isDate(e)?t(e,"DateTime"):t(e,"Text")}function a(e){var t="";return _.isNumber(e)&&(t=e.toString()),t}function i(t){return e("currency")(t,"$")}function o(e){var t="";return e&&e.lookupValue&&(t=e.lookupValue),t}function n(e){var t="";return _.isBoolean(e)&&(t=e.toString()),t}function s(t,r){var a="";return _.isDate(t)&&(a="json"===r?t.toJSON():e("date")(t,r)),a}function l(e,t){var r="",a=t||"; ";return _.each(e,function(e,t){t>0&&(r+=a),r+=e}),r}function c(e,t){var r="",a=t||"; ";return _.each(e,function(e,t){t>0&&(r+=a),r+=o(e)}),r}var u={getFormattedFieldValue:t,stringifyBoolean:n,stringifyCalc:r,stringifyCurrency:i,stringifyDate:s,stringifyLookup:o,stringifyMultiChoice:l,stringifyMultiLookup:c,stringifyNumber:a};return u}angular.module("angularPoint").factory("apFormattedFieldValueService",e),e.$inject=["$filter"]}(),angular.module("angularPoint").factory("SPServices",["apWebServiceOperationConstants","apWebServiceService",function(e,t){function r(){return{header:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",footer:"</soap:Body></soap:Envelope>",payload:""}}function a(a){function l(e,t){var r;for(r=0;r<t.length;r++)"string"==typeof t[r]?g.payload+=i(t[r],e[t[r]]):_.isArray(t[r])&&2===t[r].length?g.payload+=i(t[r][0],e[t[r][1]]):"object"==typeof t[r]&&void 0!==t[r].sendNull?g.payload+=void 0===e[t[r].name]||0===e[t[r].name].length?"":i(t[r].name,e[t[r].name]):s(e.operation,"paramArray["+r+"]: "+t[r],"Invalid paramArray element passed to addToPayload()")}function d(e,t){var r=t.substring(8);return e.opheader=e.opheader.replace(t,r),e.opfooter=e.opfooter.replace(t,r),e}var p=[["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],["listItemID","ID"]];_.each(p,function(e){a[e[0]]&&!a[e[1]]&&(a[e[1]]=a[e[0]])});var f,g=new r,v=_.extend({},m,a);_.each(u,function(e){_.isString(v[e])&&(v[e]=o(v[e]))});var h=e[v.operation][0];switch(g.opheader="<"+v.operation+" xmlns='"+t.xmlns(h)+"' >",f=t.action(h),f+=v.operation,g.opfooter="</"+v.operation+">",v.operation){case"GetAlerts":break;case"DeleteAlerts":for(g.payload+="<IDs>",c=0;c<v.IDs.length;c++)g.payload+=i("string",v.IDs[c]);g.payload+="</IDs>";break;case"Mode":break;case"Login":l(v,["username","password"]);break;case"CopyIntoItems":for(l(v,["SourceUrl"]),g.payload+="<DestinationUrls>",c=0;c<v.DestinationUrls.length;c++)g.payload+=i("string",v.DestinationUrls[c]);g.payload+="</DestinationUrls>",l(v,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(l(v,["SourceUrl"]),g.payload+="<DestinationUrls>",c=0;c<v.DestinationUrls.length;c++)g.payload+=i("string",v.DestinationUrls[c]);g.payload+="</DestinationUrls>";break;case"GetItem":l(v,["Url","Fields","Stream"]);break;case"GetForm":l(v,["listName","formUrl"]);break;case"GetFormCollection":l(v,["listName"]);break;case"AddAttachment":l(v,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":l(v,["listName","message"]);break;case"AddList":l(v,["listName","description","templateID"]);break;case"AddListFromFeature":l(v,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":l(v,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":l(v,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":l(v,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":l(v,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":l(v,["listName","listItemID","url"]);break;case"DeleteContentType":l(v,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":l(v,["listName","contentTypeId","documentUri"]);break;case"DeleteList":l(v,["listName"]);break;case"GetAttachmentCollection":l(v,["listName",["listItemID","ID"]]);break;case"GetList":l(v,["listName"]);break;case"GetListAndView":l(v,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":l(v,["listName","contentTypeId"]);break;case"GetListContentTypes":l(v,["listName"]);break;case"GetListItems":l(v,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":l(v,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":l(v,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":l(v,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":l(v,["pageUrl"]);break;case"UpdateContentType":l(v,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":l(v,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":l(v,["listName","contentTypeId","newDocument"]);break;case"UpdateList":l(v,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(l(v,["listName"]),"undefined"!=typeof v.updates&&v.updates.length>0)l(v,["updates"]);else{for(g.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+v.batchCmd+"'>",c=0;c<v.valuePairs.length;c++)g.payload+="<Field Name='"+v.valuePairs[c][0]+"'>"+n(v.valuePairs[c][1])+"</Field>";"New"!==v.batchCmd&&(g.payload+="<Field Name='ID'>"+v.ID+"</Field>"),g.payload+="</Method></Batch></updates>"}break;case"AddMeeting":l(v,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":l(v,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":l(v,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":l(v,["title"]);break;case"ResolvePrincipals":l(v,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":l(v,["searchText","maxResults","principalType"]);break;case"AddPermission":l(v,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":l(v,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":l(v,["objectName","objectType"]);break;case"RemovePermission":l(v,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":l(v,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":l(v,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":g.opheader="<"+v.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",f="http://microsoft.com/webservices/OfficeServer/QueryService/"+v.operation;break;case"GetQuerySuggestions":g.opheader="<"+v.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",f="http://microsoft.com/webservices/OfficeServer/QueryService/"+v.operation,g.payload+=i("queryXml",o(v.queryXml));break;case"GetSearchMetadata":g.opheader="<"+v.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",f="http://microsoft.com/webservices/OfficeServer/QueryService/"+v.operation;break;case"Query":g.payload+=i("queryXml",o(v.queryXml));break;case"QueryEx":g.opheader="<"+v.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",f="http://microsoft.com/webservices/OfficeServer/QueryService/"+v.operation,g.payload+=i("queryXml",o(v.queryXml));break;case"Registration":g.payload+=i("registrationXml",o(v.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":l(v,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":l(v,["strFolderUrl"]);break;case"GetAttachments":l(v,["strListName","strItemId"]);break;case"SiteDataGetList":l(v,["strListName"]),g=d(g,v.operation);break;case"SiteDataGetListCollection":g=d(g,v.operation);break;case"SiteDataGetSite":g=d(g,v.operation);break;case"SiteDataGetSiteUrl":l(v,["Url"]),g=d(g,v.operation);break;case"SiteDataGetWeb":g=d(g,v.operation);break;case"CreateWeb":l(v,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":l(v,["url"]);break;case"GetSite":l(v,["SiteUrl"]);break;case"GetSiteTemplates":l(v,["LCID","TemplateList"]);break;case"AddComment":l(v,["url","comment","isHighPriority","title"]);break;case"AddTag":l(v,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":l(v,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":l(v,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":l(v,["userAccountName","url"]);break;case"CountCommentsOnUrl":l(v,["url"]);break;case"CountRatingsOnUrl":l(v,["url"]);break;case"CountTagsOfUser":l(v,["userAccountName"]);break;case"DeleteComment":l(v,["url","lastModifiedTime"]);break;case"DeleteRating":l(v,["url"]);break;case"DeleteTag":l(v,["url","termID"]);break;case"DeleteTagByKeyword":l(v,["url","keyword"]);break;case"DeleteTags":l(v,["url"]);break;case"GetAllTagTerms":l(v,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":l(v,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":l(v,["termID"]);break;case"GetAllTagUrlsByKeyword":l(v,["keyword"]);break;case"GetCommentsOfUser":l(v,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":l(v,["userAccountName","url"]);break;case"GetCommentsOnUrl":l(v,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof v.excludeItemsTime&&v.excludeItemsTime.length>0&&(g.payload+=i("excludeItemsTime",v.excludeItemsTime));break;case"GetRatingAverageOnUrl":l(v,["url"]);break;case"GetRatingOfUserOnUrl":l(v,["userAccountName","url"]);break;case"GetRatingOnUrl":l(v,["url"]);break;case"GetRatingsOfUser":l(v,["userAccountName"]);break;case"GetRatingsOnUrl":l(v,["url"]);break;case"GetSocialDataForFullReplication":l(v,["userAccountName"]);break;case"GetTags":l(v,["url"]);break;case"GetTagsOfUser":l(v,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":l(v,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":l(v,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":l(v,["url","maximumItemsToReturn"]);break;case"GetTagUrls":l(v,["termID"]);break;case"GetTagUrlsByKeyword":l(v,["keyword"]);break;case"GetTagUrlsOfUser":l(v,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":l(v,["keyword","userAccountName"]);break;case"SetRating":l(v,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":l(v,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":l(v,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":l(v,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":l(v,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":l(v,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":l(v,["termIds","lcid"]);break;case"GetTermsByLabel":l(v,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":l(v,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":l(v,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":l(v,["groupName","roleName"]);break;case"AddRole":l(v,["roleName","description","permissionMask"]);break;case"AddRoleDef":l(v,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":l(v,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":l(v,["roleName","usersInfoXml"]);break;case"AddUserToGroup":l(v,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":l(v,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":l(v,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":l(v,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":l(v,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":l(v,["groupName"]);break;case"GetRoleCollection":l(v,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":l(v,["groupName"]);break;case"GetRoleCollectionFromUser":l(v,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":l(v,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":l(v,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":l(v,["groupName"]);break;case"GetUserCollectionFromRole":l(v,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":l(v,["userLoginName"]);break;case"GetUserLoginFromEmail":l(v,["emailXml"]);break;case"RemoveGroup":l(v,["groupName"]);break;case"RemoveGroupFromRole":l(v,["roleName","groupName"]);break;case"RemoveRole":l(v,["roleName"]);break;case"RemoveUserCollectionFromGroup":l(v,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":l(v,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":l(v,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":l(v,["groupName","userLoginName"]);break;case"RemoveUserFromRole":l(v,["roleName","userLoginName"]);break;case"RemoveUserFromSite":l(v,["userLoginName"]);break;case"RemoveUserFromWeb":l(v,["userLoginName"]);break;case"UpdateGroupInfo":l(v,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":l(v,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":l(v,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":l(v,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":l(v,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":l(v,["accountName","name","url","group","privacy"]);break;case"AddMembership":l(v,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":l(v,["accountName","name","url"]);break;case"CreateMemberGroup":l(v,["membershipInfo"]);break;case"CreateUserProfileByAccountName":l(v,["accountName"]);break;case"GetCommonColleagues":l(v,["accountName"]);break;case"GetCommonManager":l(v,["accountName"]);break;case"GetCommonMemberships":l(v,["accountName"]);break;case"GetInCommon":l(v,["accountName"]);break;case"GetPropertyChoiceList":l(v,["propertyName"]);break;case"GetUserColleagues":l(v,["accountName"]);break;case"GetUserLinks":l(v,["accountName"]);break;case"GetUserMemberships":l(v,["accountName"]);break;case"GetUserPinnedLinks":l(v,["accountName"]);break;case"GetUserProfileByGuid":l(v,["guid"]);break;case"GetUserProfileByIndex":l(v,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof v.accountName&&v.accountName.length>0?l(v,[["AccountName","accountName"]]):l(v,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":l(v,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":l(v,["accountName","newData"]);break;case"RemoveAllColleagues":l(v,["accountName"]);break;case"RemoveAllLinks":l(v,["accountName"]);break;case"RemoveAllMemberships":l(v,["accountName"]);break;case"RemoveAllPinnedLinks":l(v,["accountName"]);break;case"RemoveColleague":l(v,["accountName","colleagueAccountName"]);break;case"RemoveLink":l(v,["accountName","id"]);break;case"RemoveMembership":l(v,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":l(v,["accountName","id"]);break;case"UpdateColleaguePrivacy":l(v,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":l(v,["accountName","data"]);break;case"UpdateMembershipPrivacy":l(v,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":l(v,["accountName","data"]);break;case"DeleteAllVersions":l(v,["fileName"]);break;case"DeleteVersion":l(v,["fileName","fileVersion"]);break;case"GetVersions":l(v,["fileName"]);break;case"RestoreVersion":l(v,["fileName","fileVersion"]);break;case"AddView":l(v,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":l(v,["listName","viewName"]);break;case"GetView":l(v,["listName","viewName"]);break;case"GetViewCollection":l(v,["listName"]);break;case"GetViewHtml":l(v,["listName","viewName"]);break;case"UpdateView":l(v,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":l(v,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":l(v,["pageUrl","webPartXml","storage"]);
break;case"AddWebPartToZone":l(v,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"GetWebPart2":l(v,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":l(v,["documentName","behavior"]);break;case"GetWebPartProperties":l(v,["pageUrl","storage"]);break;case"GetWebPartProperties2":l(v,["pageUrl","storage","behavior"]);break;case"Webs.CreateContentType":l(v,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":l(v,["webUrl"]);break;case"GetContentType":l(v,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":l(v,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":l(v,["objectUrl"]);break;case"GetWeb":l(v,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":l(v,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":l(v,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":l(v,[["pageUrl","pageURL"]]);break;case"AlterToDo":l(v,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":l(v,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":l(v,["item"]);break;case"GetToDosForItem":l(v,["item"]);break;case"GetWorkflowDataForItem":l(v,["item"]);break;case"GetWorkflowTaskData":l(v,["item","listId","taskId"]);break;case"StartWorkflow":l(v,["item","templateId","workflowParameters"])}var b=g.header+g.opheader+g.payload+g.opfooter+g.footer,y=e[v.operation][1]?f:!1;return{msg:b,SOAPEnvelope:g,SOAPAction:y}}function i(e,t){var r="undefined"!=typeof t?t:"";return"<"+e+">"+r+"</"+e+">"}function o(e){return e.replace(/([\&"<>])/g,function(e,t){return p[t]})}function n(e){return"string"==typeof e?e.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):e}function s(e){console.error(e)}var l="http://schemas.microsoft.com/sharepoint",c=0,u=["listName","description"],m={operation:"",webURL:"",makeViewDefault:!1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuePairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},d={defaults:m,encodeXml:o,generateXMLComponents:a,SCHEMASharePoint:l,SOAPEnvelope:new r};$.fn.SPFilterNode=function(e){return this.find("*").filter(function(){return this.nodeName===e})};var p={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};return $.expr[":"].regex=function(e,t,r){var a=r[3].split(","),i=/^(data|css):/,o={method:a[0].match(i)?a[0].split(":")[0]:"attr",property:a.shift().replace(i,"")},n="ig",s=new RegExp(a.join("").replace(/^\s+|\s+$/g,""),n);return s.test(jQuery(e)[o.method](o.property))},d}]),angular.module("angularPoint").factory("apUtilityService",["$q","_","apConfig","$timeout",function(e,t,r,a){function i(e){return"number"==typeof e?e>9?e.toString():"0"+e:i(parseInt(e))}function o(e){var t=e.getFullYear(),r=e.getMonth()+1,a=e.getDate();return parseInt(t+i(r)+i(a))}function n(e,t,r){if(!e||!t)return!1;r=r||new Date;var a=o(e),i=o(t),n=o(r);return n>=a&&i>=n}function s(t,r,i,o,n){function s(){c++;for(var e=+new Date,n=m;l>m&&u>m-n&&new Date-e<100;)r.call(i,t[m],m,c),m+=1;l>m?a(s,o):d.resolve(t)}var l=t.length,c=0,u=n||l,o=o||25,m=0,d=e.defer();return s(),d.promise}function l(e){var r={ViewListItems:(1&e)>0,AddListItems:(2&e)>0,EditListItems:(4&e)>0,DeleteListItems:(8&e)>0,ApproveItems:(16&e)>0,OpenItems:(32&e)>0,ViewVersions:(64&e)>0,DeleteVersions:(128&e)>0,CancelCheckout:(256&e)>0,PersonalViews:(512&e)>0,ManageLists:(2048&e)>0,ViewFormPages:(4096&e)>0,Open:(65536&e)>0,ViewPages:(131072&e)>0,AddAndCustomizePages:(262144&e)>0,ApplyThemeAndBorder:(524288&e)>0,ApplyStyleSheets:(1048576&e)>0,ViewUsageData:(2097152&e)>0,CreateSSCSite:(4194314&e)>0,ManageSubwebs:(8388608&e)>0,CreateGroups:(16777216&e)>0,ManagePermissions:(33554432&e)>0,BrowseDirectories:(67108864&e)>0,BrowseUserInfo:(134217728&e)>0,AddDelPrivateWebParts:(268435456&e)>0,UpdatePersonalWebParts:(536870912&e)>0,ManageWeb:(1073741824&e)>0,UseRemoteAPIs:(137438953472&e)>0,ManageAlerts:(274877906944&e)>0,CreateAlerts:(549755813888&e)>0,EditMyUserInfo:(1099511627776&e)>0,EnumeratePermissions:(0x4000000000000000&e)>0,FullMask:0x8000000000000000==e};return r.FullMask&&t.each(r,function(e,t){r[t]=!0}),r}function c(e){var t=null,r={EmptyMask:"0x0000000000000000",FullMask:"0x7FFFFFFFFFFFFFFF",ViewListItems:"0x0000000000000001",AddListItems:"",EditListItems:"0x0000000000000004",DeleteListItems:"0x0000000000000008",ApproveItems:"0x0000000000000010",OpenItems:"0x0000000000000020",ViewVersions:"0x0000000000000040",DeleteVersions:"0x0000000000000080",CancelCheckout:"0x0000000000000100",ManagePersonalViews:"0x0000000000000200",ManageLists:"0x0000000000000800",ViewFormPages:"0x0000000000001000",Open:"0x0000000000010000",ViewPages:"0x0000000000020000",AddAndCustomizePages:"0x0000000000040000",ApplyThemeAndBorder:"0x0000000000080000",ApplyStyleSheets:"0x0000000000100000",ViewUsageData:"0x0000000000200000",CreateSSCSite:"0x0000000000400000",ManageSubwebs:"0x0000000000800000",CreateGroups:"0x0000000001000000",ManagePermissions:"0x0000000002000000",BrowseDirectories:"0x0000000004000000",BrowseUserInfo:"0x0000000008000000",AddDelPrivateWebParts:"0x0000000010000000",UpdatePersonalWebParts:"0x0000000020000000",ManageWeb:"0x0000000040000000",UseClientIntegration:"0x0000001000000000",UseRemoteAPIs:"0x0000002000000000",ManageAlerts:"0x0000004000000000",CreateAlerts:"0x0000008000000000",EditMyUserInfo:"0x0000010000000000",EnumeratePermissions:"0x4000000000000000"};return r[e]&&(t=r[e]),t}function u(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0==t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}function m(e){return e.replace(/([A-Z])/g," $1").replace(/^./,function(e){return e.toUpperCase()})}function d(e){var t=e.split(";#");this.id=parseInt(t[0],10),this.value=t[1]}function p(e){var r;return t.isObject(e)?r=f(e).replace(/\s+/g," "):t.isString(e)&&(r=e),r}function f(e){var t;return t="undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(e):e.xml}function g(){}return t.mixin({isDefined:function(e){return!t.isUndefined(e)},isGuid:function(e){return"string"==typeof e&&/[a-fA-F\d]{8}-(?:[a-fA-F\d]{4}-){3}[a-fA-F\d]{12}/.test(e)}}),{batchProcess:s,convertEffectivePermMask:c,dateWithinRange:n,doubleDigit:i,fromCamelCase:m,registerChange:g,resolvePermissions:l,SplitIndex:d,stringifyXML:p,toCamelCase:u,yyyymmdd:o}}]),angular.module("angularPoint").factory("apWebServiceService",function(){function e(e){return a[e]?a[e].action:r+"/soap/"}function t(e){return a[e]?a[e].xmlns:r+"/soap/"}var r="http://schemas.microsoft.com/sharepoint",a={Alerts:{action:r+"/soap/2002/1/alerts/",xmlns:r+"/soap/2002/1/alerts/"},Meetings:{action:r+"/soap/meetings/",xmlns:r+"/soap/meetings/"},Permissions:{action:r+"/soap/directory/",xmlns:r+"/soap/directory/"},PublishedLinksService:{action:"http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/"},Search:{action:"urn:Microsoft.Search/",xmlns:"urn:Microsoft.Search"},SharePointDiagnostics:{action:"http://schemas.microsoft.com/sharepoint/diagnostics/",xmlns:r+"/diagnostics/"},SocialDataService:{action:"http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/SocialDataService"},SpellCheck:{action:"http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck",xmlns:"http://schemas.microsoft.com/sharepoint/publishing/spelling/"},TaxonomyClientService:{action:r+"/taxonomy/soap/",xmlns:r+"/taxonomy/soap/"},usergroup:{action:r+"/soap/directory/",xmlns:r+"/soap/directory/"},UserProfileService:{action:"http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/UserProfileService"},WebPartPages:{action:"http://microsoft.com/sharepoint/webpartpages/",xmlns:"http://microsoft.com/sharepoint/webpartpages"},Workflow:{action:r+"/soap/workflow/",xmlns:r+"/soap/workflow/"}},i=["Alerts","Authentication","Copy","Forms","Lists","Meetings","People","Permissions","PublishedLinksService","Search","SharePointDiagnostics","SiteData","Sites","SocialDataService","SpellCheck","TaxonomyClientService","usergroup","UserProfileService","Versions","Views","WebPartPages","Webs","Workflow"];return{action:e,webServices:i,xmlns:t}}),angular.module("angularPoint").service("apXMLToJSONService",["_","apDecodeService",function(e,t){return function(r,a){var i={mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},o=e.extend({},i,a),n=[];return e.each(r,function(r){var a={},i=r.attributes;o.sparse||e.each(o.mapping,function(e){a[e.mappedName]=""}),e.each(i,function(e){var r=e.name,i=o.mapping[r],n="undefined"!=typeof i?i.mappedName:o.removeOws?r.split("ows_")[1]:r,s="undefined"!=typeof i?i.objectType:void 0;(o.includeAllAttrs||void 0!==i)&&(a[n]=t.parseStringValue(e.value,s))}),n.push(a)}),n}}]);