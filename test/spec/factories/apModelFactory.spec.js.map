{"version":3,"sources":["spec/factories/apModelFactory.spec.ts"],"names":["ap","getResponseXML","mockExecuteQuery"],"mappings":"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","file":"spec/factories/apModelFactory.spec.js","sourcesContent":["/// <reference path=\"../../mock/app.module.mock.ts\" />\r\nmodule ap {\r\n    'use strict';\r\n\r\n    describe('Factory: apModelFactory', function() {\r\n\r\n        beforeEach(module(\"angularPoint\"));\r\n\r\n        var factory: ModelFactory, mockModel: MockModel, mockEntityCache, mockXMLService, $rootScope: ng.IRootScopeService, $q:ng.IQService, apDataService: DataService, $httpBackend;\r\n\r\n        beforeEach(inject(function(_mockModel_, _apModelFactory_, _mockXMLService_, _$rootScope_, _$q_, _apDataService_, _$httpBackend_) {\r\n            mockModel = _mockModel_;\r\n            factory = _apModelFactory_;\r\n            mockXMLService = _mockXMLService_;\r\n            apDataService = _apDataService_;\r\n            $httpBackend = _$httpBackend_;\r\n            $rootScope = _$rootScope_;\r\n            $q = _$q_;\r\n            mockModel.importMocks();\r\n            mockEntityCache = mockModel.getCache('primary');\r\n        }));\r\n\r\n        describe('addNewItem', function() {\r\n            it('adds the new entity to the cacheService', function() {\r\n                mockModel.addNewItem({ title: 'I am a Mock' })\r\n                    .then(function(response) {\r\n                        expect(mockModel.getCachedEntity(response.id)).toBeDefined();\r\n                        expect(response.title).toEqual('I am a Mock');\r\n                    });\r\n                $httpBackend.flush();\r\n            });\r\n        });\r\n\r\n\r\n        describe('createEmptyItem', function() {\r\n\r\n            it('should return an object', function() {\r\n                var emptyItem = mockModel.createEmptyItem();\r\n                expect(emptyItem).toBeTruthy();\r\n            });\r\n\r\n            it('should have an attribute for each of the mocked fields except for \"ReadOnly\"', function() {\r\n                var emptyItem = mockModel.createEmptyItem();\r\n                var fieldsOnModel = mockModel.list.customFields.length;\r\n                var attributesOnEmptyItem = _.keys(emptyItem).length;\r\n                expect(fieldsOnModel - 1).toBe(attributesOnEmptyItem);\r\n            });\r\n        });\r\n\r\n        //DEPRECATED\r\n        //describe('searchLocalCache', function () {\r\n        //\r\n        //    it('returns the correct object when using an attribute directly on the object', function () {\r\n        //        var searchResults = mockModel.searchLocalCache(1);\r\n        //        expect(searchResults).toEqual(mockEntityCache[1]);\r\n        //    });\r\n        //\r\n        //    it('should return the correct object when a nested property path is used', function () {\r\n        //        var searchResults = mockModel.searchLocalCache(2, {\r\n        //            propertyPath: 'lookup.lookupId'\r\n        //        });\r\n        //        expect(searchResults).toEqual(mockEntityCache[2]);\r\n        //    });\r\n        //\r\n        //    it('should return undefined if no match is found', function () {\r\n        //        var searchResults = mockModel.searchLocalCache('fake id', {\r\n        //            propertyPath: 'lookup.lookupId'\r\n        //        });\r\n        //        expect(searchResults).toBeUndefined();\r\n        //    });\r\n        //\r\n        //    describe('count the number of times the cache is rebuilt', function () {\r\n        //\r\n        //        it('doesn\\'t use the cache when searching by id', function () {\r\n        //            mockModel.searchLocalCache(1);\r\n        //            mockModel.searchLocalCache(2);\r\n        //\r\n        //            expect(mockModel._cachedIndexes).toBeUndefined();\r\n        //        });\r\n        //\r\n        //        it('uses the cached results instead of building a new cache', function () {\r\n        //            mockModel.searchLocalCache(1, {\r\n        //                propertyPath: 'lookup.lookupId'\r\n        //            });\r\n        //            var initialBuildCount = getBuildCount();\r\n        //            mockModel.searchLocalCache(1, {\r\n        //                propertyPath: 'lookup.lookupId'\r\n        //            });\r\n        //            expect(initialBuildCount).toEqual(getBuildCount());\r\n        //        });\r\n        //\r\n        //        it('rebuilds the cache when a change is made', function () {\r\n        //            mockModel.searchLocalCache(1, {\r\n        //                propertyPath: 'lookup.lookupId'\r\n        //            });\r\n        //\r\n        //            var initialBuildCount = getBuildCount();\r\n        //\r\n        //            /** Add another entity to the cache */\r\n        //            mockModel.getCache()[3] = new mockModel.factory({\r\n        //                lookup: {lookupId: 3},\r\n        //                id: 3\r\n        //            });\r\n        //\r\n        //            mockModel.searchLocalCache(2, {\r\n        //                propertyPath: 'lookup.lookupId'\r\n        //            });\r\n        //\r\n        //            expect(initialBuildCount).not.toEqual(getBuildCount());\r\n        //        });\r\n        //    });\r\n        //\r\n        //    it('returns an array of items if an array is specified', function () {\r\n        //\r\n        //        expect(mockModel.searchLocalCache([1, 2]).length).toEqual(2);\r\n        //    });\r\n        //\r\n        //    function getBuildCount() {\r\n        //        return mockModel._cachedIndexes.main.lookup.lookupId.buildCount;\r\n        //    }\r\n        //\r\n        //\r\n        //});\r\n\r\n        describe('Method: getListItemById', function() {\r\n            it('returns a single list item', function() {\r\n                mockModel.getListItemById(1)\r\n                    .then(function(response) {\r\n                        expect(response.id).toEqual(1);\r\n                    });\r\n                $httpBackend.flush();\r\n            });\r\n            //it('returns undefined if no matching record is found', function () {\r\n            //    mockXMLService.xhrStub('emptyResponse');\r\n            //    mockModel.getListItemById(5)\r\n            //        .then(function (response) {\r\n            //            expect(response).toBeUndefined();\r\n            //        });\r\n            //    $rootScope.$digest();\r\n            //});\r\n        });\r\n\r\n        describe('Method: getAllListItems', function() {\r\n            it('returns both expected entities', function() {\r\n                mockModel.getAllListItems(1)\r\n                    .then(function(response) {\r\n                        expect(response.count()).toEqual(2);\r\n                    });\r\n                $httpBackend.flush();\r\n            });\r\n        });\r\n\r\n        describe('Method: getQuery', function() {\r\n            it('returns the query by name', function() {\r\n                expect(mockModel.getQuery('primary')).toBe(mockModel.queries.primary);\r\n            });\r\n            it('returns undefined if a query is requested that hasn\\'t been registered', function() {\r\n                expect(mockModel.getQuery('never registered')).toBeUndefined();\r\n            });\r\n        });\r\n\r\n        describe('Method: getFieldDefinition', function() {\r\n            it('correctly looks up the field definition given the field name', function() {\r\n                expect(mockModel.getFieldDefinition('id')).toBe(mockModel.list.fields[0]);\r\n            });\r\n        });\r\n\r\n        describe('Method: extendListMetadata', function() {\r\n            it('extends the list information from xml', function() {\r\n                mockModel.deferredListDefinition = null;\r\n                mockModel.extendListMetadata();\r\n                $httpBackend.flush();\r\n                expect(mockModel.deferredListDefinition).not.toBeNull();\r\n            });\r\n\r\n            it('only fetches the list definition once although it\\'s requested multiple times', function() {\r\n                spyOn(apDataService, 'getList').and.callThrough();\r\n                mockModel.deferredListDefinition = null;\r\n                mockModel.extendListMetadata();\r\n                mockModel.extendListMetadata();\r\n                $httpBackend.flush();\r\n                expect(apDataService.getList.calls.count()).toEqual(1);\r\n            });\r\n        });\r\n\r\n        describe('Method: isInitialized', function() {\r\n            it('should return true if an initial query has been made', function() {\r\n                mockModel.executeQuery('primary');\r\n                expect(mockModel.isInitialised()).toBe(true);\r\n            });\r\n        });\r\n\r\n        describe('Method: generateMockData', function() {\r\n            it('creates n mock records', function() {\r\n                expect(mockModel.generateMockData({ quantity: 12 }).length)\r\n                    .toEqual(12);\r\n            });\r\n        });\r\n\r\n        describe('Method: validateEntity', function() {\r\n            it('validates a valid entity', function() {\r\n                expect(mockModel.validateEntity(mockEntityCache[1])).toBe(true);\r\n            });\r\n\r\n            it('rejects a null value', function() {\r\n                mockEntityCache[1].boolean = null;\r\n                expect(mockModel.validateEntity(mockEntityCache[1])).toBe(false);\r\n            });\r\n        });\r\n\r\n        describe('Method: resolvePermissions', function() {\r\n            it('correctly identifies that the user can approve', function() {\r\n                mockModel.list.permissions = new ap.BasePermissionObject();\r\n                mockModel.list.permissions['ApproveItems'] = true;\r\n                expect(mockModel.resolvePermissions().ApproveItems).toBe(true);\r\n            });\r\n            it('falls back to use permission from first list item to resolve', function() {\r\n                let initialPermissions = mockModel.resolvePermissions();\r\n                expect(initialPermissions.AddListItems).toEqual(true);\r\n                //Make sure not to use saved permissions on list\r\n                mockModel.list.permissions = undefined;\r\n                //Update value on first list item which is what will be used to populate list permissions\r\n                var firstListItemPermissions = mockModel.getCachedEntities().first().resolvePermissions();\r\n\r\n                //Service will attempt to use same permissions as an existing list item\r\n                expect(mockModel.resolvePermissions()).toEqual(firstListItemPermissions);\r\n            });\r\n            it('correctly identifies that the user doesn\\'t have the required permissions', function() {\r\n                //Clear out any list permissions\r\n                mockModel.list.permissions = undefined;\r\n                let firstListItem = mockModel.getCachedEntities().first();\r\n                //Set permissions to allow approving list items\r\n                firstListItem.permMask = '0x0000000000000010';\r\n                let updatedPermissions = mockModel.resolvePermissions();\r\n\r\n                expect(firstListItem.resolvePermissions()).toEqual(updatedPermissions);\r\n\r\n                expect(updatedPermissions.EditListItems).toEqual(false);\r\n                expect(updatedPermissions.ApproveItems).toEqual(true);\r\n\r\n                mockModel.list.permissions = undefined;\r\n                //Update the permMask for the first list item, giving the user only the ability to ViewListItems\r\n                firstListItem.permMask = '0x0000000000000001';\r\n                updatedPermissions = mockModel.resolvePermissions();\r\n\r\n                expect(firstListItem.resolvePermissions()).toEqual(updatedPermissions);\r\n\r\n                expect(updatedPermissions.ViewListItems).toEqual(true);\r\n                expect(updatedPermissions.ApproveItems).toEqual(false);\r\n\r\n            });\r\n        });\r\n\r\n        function getResponseXML() {\r\n            var deferred = $q.defer();\r\n            deferred.resolve(mockXMLService.listItemsSinceChangeToken);\r\n            return deferred.promise;\r\n        }\r\n\r\n        function mockExecuteQuery() {\r\n            var deferred = $q.defer();\r\n            deferred.resolve(mockModel.getCache());\r\n            return deferred.promise;\r\n        }\r\n\r\n\r\n        //describe('Method: getLocalEntity', function () {\r\n        //    it('finds the correct entity using the list item id', function () {\r\n        //        expect(mockModel.getLocalEntity(2)).toEqual(mockEntityCache[2]);\r\n        //    });\r\n        //});\r\n    });\r\n}"],"sourceRoot":"/source/"}