{"version":3,"sources":["mock/apMockBackend.mock.ts"],"names":["ap","ap.ModelChangeQueue","ap.ModelChangeQueue.constructor","ap.ModelChangeQueue.clear","ap.getMockId","ap.MockBackend","ap.MockBackend.constructor","routeMatcher","ap.MockBackend.constructor.ChangeCallback","ap.MockBackend.constructor.getListItems","ap.MockBackend.constructor.getListItemById","ap.MockBackend.constructor.getZRows","ap.MockBackend.constructor.convertUpdateRequestToResponse","ap.MockBackend.constructor.createZRow","ap.MockBackend.constructor.getMockUser","ap.MockBackend.constructor.updateListItem","ap.MockBackend.constructor.getListItemChangesSinceToken","ap.MockBackend.constructor.buildRSDataNode","ap.MockBackend.constructor.getChangesSinceToken","ap.MockBackend.constructor.registerUpdate","ap.MockBackend.constructor.registerDeletion","ap.MockBackend.constructor.getChangeTokenCache","ap.MockBackend.constructor.registerChangeToken","ap.MockBackend.constructor.generateChangeToken","ap.MockBackend.constructor.listsResponseEnvelope","ap.MockBackend.constructor.getListModel","ap.MockBackend.constructor.getListId","ap.MockBackend.constructor.getChangeToken","ap.MockBackend.constructor.getXMLNodeContents","ap.MockBackend.constructor.generateMockListItems","ap.MockBackend.constructor.getNamedListItems","ap.MockBackend.constructor.getCachedResponse","ap.MockBackend.constructor.responder"],"mappings":"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","file":"mock/apMockBackend.mock.js","sourcesContent":["/// <reference path=\"../../typings/ap.d.ts\" />\n/// <reference path=\"../../typings/tsd.d.ts\" />\n\nmodule ap {\n    'use strict';\n\n    export interface ICachedXML {\n        lists: {\n            [key: string]: { //List Item GUID\n                //Each list can have cached response for each type of call\n                GetListItemChangesSinceToken?: string;\n                GetListItems?: string;\n            }\n        }\n        operations: { //Common Cached Requests\n            AddAttachment?: string;\n            DeleteAttachment?: string;\n            GenericEmpty?: string;\n            GetAttachmentCollection?: string;\n            GetGroupCollectionFromSite?: string;\n            GetGroupCollectionFromUser?: string;\n            GetList?: string;\n            GetListCollection?: string;\n            GetTemplatesForItem?: string;\n            GetUserCollectionFromGroup?: string;\n            GetUserCollectionFromSite?: string;\n            GetUserProfileByName?: string;\n            GetVersionCollection?: string;\n            GetView?: string;\n            GetWorkflowDataForItem?: string;\n            StartWorkflow?: string;\n            UpdateListItems?: string;\n            WebUrlFromPageUrl?: string;\n        }\n    }\n\n    class ModelChangeQueue {\n        pendingDeletions = [];\n        pendingUpdates = [];\n        constructor(private token: string) { }\n        clear(updatedToken: string) {\n            this.token = updatedToken || '';\n            this.pendingDeletions = [];\n            this.pendingUpdates = [];\n        }\n    }\n\n    var activeEntities: { [key: number]: ListItem<any> } = {}, //{ listItem.id: ListItem, ...}\n        changeQueue: { [key: string]: ModelChangeQueue } = {},\n        mockId = 10000,\n        xmlNS = {\n            listItems: `xmlns:s=\"uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882\" xmlns:dt=\"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882\" xmlns:rs=\"urn:schemas-microsoft-com:rowset\" xmlns:z=\"#RowsetSchema\"`,\n            soap: `xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"`\n        };\n\n\n    function getMockId() {\n        return mockId++;\n    }\n\n    export class MockBackend {\n        constructor($httpBackend: ng.IHttpBackendService, apCachedXML: ICachedXML, apCacheService: CacheService, apWebServiceService: WebServiceService,\n            apUtilityService: UtilityService, $injector: ng.auto.IInjectorService, apEncodeService: EncodeService, apChangeService: ChangeService) {\n\n\n\n            /** Listen for each of the standard services being called and try to return a cached XML response for the\n             * operation */\n            _.each(apWebServiceService.webServices, function(service) {\n                /** Lists has many special cases so don't create generic backend for it */\n                if (service !== 'Lists') {\n                    $httpBackend.whenPOST(function routeMatcher(url) {\n                        return url.indexOf('bin/' + service + '.asmx') > -1;\n                    })\n                        .respond(function(method, url, data) {\n                            var requestXML = $.parseXML(data);\n                            /** Get the xml namespace for the current service */\n                            var soapAction = apWebServiceService.xmlns(service);\n                            var request = $(requestXML).find('[xmlns^=\"' + soapAction + '\"]');\n                            var operation = request[0].nodeName;\n                            var responseXML = apCachedXML.operations[operation];\n                            return responder(responseXML);\n                        });\n                }\n            });\n\n            $httpBackend.whenPOST(/Lists.asmx/)\n                .respond(function(method: string, url: string, data: string) {\n                    var requestXML = $.parseXML(data);\n                    var request = $(requestXML).find('[xmlns^=\"http://schemas.microsoft.com/sharepoint/\"]');\n                    var operation = request[0].nodeName;\n                    var responseXML;\n\n                    switch (operation) {\n                        case 'GetListItems':\n                            responseXML = getListItems(request);\n                            break;\n                        case 'GetList':\n                        case 'GetListItemChangesSinceToken':\n                            responseXML = getListItemChangesSinceToken(data, request);\n                            break;\n                        case 'UpdateListItems':\n                            responseXML = updateListItem(request);\n                            break;\n\n                        default:\n                            responseXML = apCachedXML.operations[operation];\n                    }\n                    return responder(responseXML);\n                });\n\n\n            apChangeService.subscribeToUpdates(function ChangeCallback(entity: ListItem<any>, options, promise) {\n                activeEntities[entity.id] = entity;\n            });\n\n\n\n\n\n            /////////////////////////// PRIVATE ////////////////////////////////\n\n\n            function getListItems(request: JQuery) {\n                var zrows = [];\n                var rowLimit = $(request).find('rowLimit').text();\n                if (rowLimit === \"1\") {\n                    var zrow = getListItemById(request);\n                    if (!zrow) {\n                        /** A match wasn't found so return a mock */\n                        zrow = generateMockListItems(request, 1)[0];\n                    }\n                    zrows.push(zrow);\n                } else {\n                    zrows = getZRows(request);\n                }\n\n                var responseEnvelope = listsResponseEnvelope('GetListItems');\n                var payload = '<listitems ' + xmlNS.listItems + '>' + buildRSDataNode(zrows) + '</listitems>';\n\n                return responseEnvelope.header + payload + responseEnvelope.footer;\n            }\n\n            /**\n             * @ngdoc function\n             * @name getListItemById\n             * @description\n             * Attempts to retrieve an xml zrow from cached xml.\n             * @param {xml} request XML Request.\n             * @returns {xml} zrow\n             */\n            function getListItemById(request: JQuery): JQuery {\n                var match;\n                /** Retrieve the list item id */\n                var id = $(request).find('Query').find('Value[Type=\"Number\"]').text();\n                var rows = getZRows(request);\n\n                /** Attempt to find the requested list item in the cached xml */\n                _.each(rows, function(row) {\n                    if ($(row).attr('ows_ID') == id) {\n                        match = row;\n                        /** Break loop */\n                        return false;\n                    }\n                });\n\n                /** Returns a single entity */\n                return match;\n            }\n\n            function getZRows(request: JQuery): JQuery[] {\n                var responseXML = getNamedListItems('GetListItems', request);\n\n                var parsedXML = $.parseXML(responseXML);\n                return $(parsedXML).SPFilterNode('z:row');\n            }\n\n            function convertUpdateRequestToResponse(request: JQuery, optionalAttributes): string {\n                var fields = $(request).find('Field');\n                var changeObject = {};\n                _.each(fields, function(field: JQuery) {\n                    var fieldName = $(field).attr('Name');\n                    var fieldValue = $(field).text();\n                    changeObject[fieldName] = _.unescape(fieldValue);\n                });\n                _.extend(changeObject, optionalAttributes);\n                return createZRow(changeObject);\n            }\n\n            function createZRow(changeObject: Object): string {\n                var zrow = '<z:row ';\n                _.each(changeObject, function(fieldValue: string, fieldName: string) {\n                    zrow += ' ows_' + fieldName + '=\"' + _.escape(fieldValue) + '\"';\n                });\n                zrow += ' xmlns:z=\"#RowsetSchema\"/>';\n                return zrow;\n            }\n\n            function getMockUser(): ap.IUser {\n                var mockUser = { lookupId: 100, lookupValue: 'Joe User' };\n\n                try {\n                    mockUser = $injector.get('mockUser');\n                } catch (err) {\n                    //Oh well, we tried to see if a default mock user was specified.\n                }\n                return mockUser;\n            }\n\n            function updateListItem(request: JQuery): string {\n\n                var zrow,\n                    overrides,\n                    updateMethod = request.find('Method'),\n                    cmd = updateMethod.attr('Cmd');\n\n                switch (cmd) {\n                    /** Create list item */\n                    case 'New':\n                        var model = getListModel(request);\n                        /** Need to create an id so find set it 1 higher than the id of the most recent entity */\n                        var lastEntity = model.getCachedEntities().last();\n                        var mockId = lastEntity ? lastEntity.id + 1 : getMockId();\n\n                        //Mock Fields that would be set upon list item creation\n                        overrides = {\n                            ID: mockId,\n                            Modified: apEncodeService.encodeValue('DateTime', new Date()),\n                            Created: apEncodeService.encodeValue('DateTime', new Date()),\n                            Author: apEncodeService.encodeValue('User', getMockUser()),\n                            Editor: apEncodeService.encodeValue('User', getMockUser()),\n                            PermMask: '0x7fffffffffffffff',\n                            UniqueId: mockId + ';#{11FF840D-9CE1-4961-B7FD-51B9DF07706B}',\n                            FileRef: mockId + ';#sitecollection/site/ListName/' + mockId + '_.000'\n                        }\n\n                        zrow = convertUpdateRequestToResponse(request, overrides);\n                        registerUpdate(request, zrow);\n                        break;\n                    case 'Update':\n                        var listItemStrId = $(request).find('Field[Name=\"ID\"]').text();\n                        var activeEntity = activeEntities[listItemStrId];\n\n                        //Mock fields that would be updated when a list item is update\n                        overrides = {\n                            Modified: apEncodeService.encodeValue('DateTime', new Date()),\n                            Editor: apEncodeService.encodeValue('User', getMockUser()),\n                            Version: activeEntity.version ? activeEntity.version + 1 : 2\n                        };\n\n                        var fieldDefinitions = activeEntity.getList().customFields;\n                        var valuePairs = apEncodeService.generateValuePairs(fieldDefinitions, activeEntity);\n                        var encodedValues = {};\n                        _.each(valuePairs, function(pair) {\n                            encodedValues[pair[0]] = pair[1];\n                        });\n\n                        var opts = _.extend({}, encodedValues, overrides);\n\n                        zrow = convertUpdateRequestToResponse(request, opts);\n                        registerUpdate(request, zrow);\n\n                        //Cleanup\n                        delete activeEntities[listItemStrId];\n                        break;\n                    case 'Delete':\n                        /** No z:row element when deleted */\n                        zrow = '';\n                        _.each($(request).find('Field'), function(field) {\n                            var fieldId = parseInt($(field).text(), 10);\n                            registerDeletion(request, fieldId);\n                        });\n                        break;\n                }\n\n                var responseEnvelope = listsResponseEnvelope('UpdateListItems');\n\n                var payload = `<Results><Result ID=\"1,${cmd}\"><ErrorCode>0x00000000</ErrorCode>${zrow}</Result></Results>`;\n                var xmlResponse = responseEnvelope.header + payload + responseEnvelope.footer;\n                return xmlResponse;\n            }\n\n\n            function getListItemChangesSinceToken(data: string, request: JQuery): string {\n                var responseXML, responseEnvelope, changeNodes, payload;\n                var changeToken = getChangeToken(request);\n                var newChangeToken = generateChangeToken(request);\n                if (changeToken) {\n                    /** Follow on request */\n                    responseEnvelope = listsResponseEnvelope('GetListItemChangesSinceToken');\n                    changeNodes = getChangesSinceToken(request, newChangeToken);\n                    payload = `<listitems ${xmlNS.listItems}> ${changeNodes.changes} ${changeNodes.rsdata}</listitems>`;\n                    responseXML = responseEnvelope.header + payload + responseEnvelope.footer;\n                } else {\n                    var model = getListModel(request);\n                    registerChangeToken(request, newChangeToken);\n                    /** Initial request so register this token */\n                    if (apCachedXML.lists[model.list.title] && apCachedXML.lists[model.list.title].GetListItemChangesSinceToken) {\n                        /** Use Cached XML */\n                        responseXML = apCachedXML.lists[model.list.title].GetListItemChangesSinceToken;\n                    } else {\n                        /** Generate mocks if no cached XML is found */\n                        responseEnvelope = listsResponseEnvelope('GetListItemChangesSinceToken');\n                        /** Add mocked items to change queue */\n                        changeQueue[model.list.guid].pendingUpdates = generateMockListItems(request, 10);\n                        changeNodes = getChangesSinceToken(request, newChangeToken);\n                        payload = `<listitems ${xmlNS.listItems}>${changeNodes.changes} ${changeNodes.rsdata}</listitems>`;\n                        responseXML = responseEnvelope.header + payload + responseEnvelope.footer;\n                    }\n                }\n                return responseXML;\n            }\n\n            function buildRSDataNode(zrows: JQuery[]): string {\n\n                var rsdata = '<rs:data ItemCount=\"' + zrows.length + '\">';\n                _.each(zrows, function(zrow: JQuery) {\n                    /** Work with zrows that have been parsed to xml as well as those that are still strings */\n                    rsdata += typeof zrow === 'object' ? apUtilityService.stringifyXML(zrow) : zrow;\n                });\n                rsdata += '</rs:data>';\n                return rsdata;\n            }\n\n            function getChangesSinceToken(request: JQuery, token: string): { changes: string; rsdata: string; } {\n                var response = { changes: '', rsdata: '' };\n                var model = getListModel(request);\n                var changesSinceToken = getChangeTokenCache(request);\n                /** Build XML for any list items that have been added or updated */\n                response.rsdata = buildRSDataNode(changesSinceToken.pendingUpdates);\n\n                /* Build Changes XML node for entities that have been deleted.  There are other valid changes [Restore] but\n                 at this point we're only concerned with mocking deleted items */\n                response.changes = '<Changes LastChangeToken=\"' + token + '\">';\n                if (changesSinceToken.pendingDeletions.length > 0) {\n                    _.each(changesSinceToken.pendingDeletions, function(listItemId) {\n                        response.changes += '<Id ChangeType=\"Delete\" UniqueId=\"\">' + listItemId + '</Id>';\n                    });\n                }\n                response.changes += '</Changes>';\n\n                /** Clear out changes for next time */\n                changesSinceToken.clear(token);\n                return response;\n            }\n\n            function registerUpdate(request: JQuery, zrow: JQuery): void {\n                getChangeTokenCache(request).pendingUpdates.push(zrow);\n            }\n\n            function registerDeletion(request: JQuery, id: number): void {\n                getChangeTokenCache(request).pendingDeletions.push(id);\n            }\n\n            function getChangeTokenCache(request: JQuery) {\n                var model = getListModel(request);\n                changeQueue[model.list.guid] =\n                changeQueue[model.list.guid] || new ModelChangeQueue(generateChangeToken(request));\n                return changeQueue[model.list.guid];\n            }\n\n            function registerChangeToken(request: JQuery, token: string): void {\n                var model = getListModel(request);\n                changeQueue[model.list.guid] = new ModelChangeQueue(token);\n            }\n\n            function generateChangeToken(request: JQuery): string {\n                var model = getListModel(request);\n                return _.uniqueId(model ? model.list.guid : '');\n            }\n\n            function listsResponseEnvelope(operation: string): { footer: string; header: string; payload: string; } {\n                var response = {\n                    footer: `</${operation}Result></${operation}Response></soap:Body></soap:Envelope>`,\n                    header: `<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope ${xmlNS.soap}><soap:Body>\n                        <${operation} Response xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\"><${operation}Result>`,\n                    payload: ''\n                };\n                return response;\n            }\n\n            function getListModel(request: JQuery): Model {\n                /** Find the list id */\n                var listGuid = getListId(request);\n                /** Check with cache service to see if a list with the matching guid has registered */\n                return apCacheService.getModel(listGuid);\n            }\n\n            function getListId(request: JQuery): string {\n                return getXMLNodeContents(request, 'listName');\n            }\n\n            function getChangeToken(request: JQuery): string {\n                return getXMLNodeContents(request, 'changeToken');\n            }\n\n            function getXMLNodeContents(request: JQuery, element): string {\n                var changeToken;\n                var changeTokenNode = $(request).find(element);\n                if (changeTokenNode.length) {\n                    changeToken = changeTokenNode.text();\n                }\n                return changeToken;\n            }\n\n            function generateMockListItems(request: JQuery, quantity: number): JQuery[] {\n                var model = getListModel(request);\n                var mockRecords = model.generateMockData({ quantity: quantity });\n                var zrows = [];\n                _.each(mockRecords, function(mockRecord) {\n                    var changeObject = {};\n                    /** Generate value pairs for each property on the mock object */\n                    var valuePairs = apEncodeService.generateValuePairs(model.list.fields, mockRecord);\n                    /** Create a key/val property for each valuePiar */\n                    _.each(valuePairs, function(valuePair) {\n                        changeObject[valuePair[0]] = valuePair[1];\n                    });\n                    zrows.push(createZRow(changeObject));\n                });\n                return zrows;\n            }\n\n            function getNamedListItems(operation: string, request: JQuery): string {\n                var responseXML;\n                /** Check with cache service to see if a list with the matching guid has registered */\n                var listModel = getListModel(request);\n                if (listModel) {\n                    /** Use the list name in the model to see if we have cached XML */\n                    responseXML = getCachedResponse(operation, listModel.list.title);\n                }\n                if (!responseXML) {\n                    console.info('No Cached Data Found For ' + listModel.list.title);\n                    /** No cached XML so just use the default operation response */\n                    responseXML = getCachedResponse(operation);\n                }\n                return responseXML;\n            }\n\n            function getCachedResponse(operation: string, fileName?: string): string {\n                var response;\n                fileName = fileName || operation;\n\n                if (apCachedXML.lists[fileName] && apCachedXML.lists[fileName][operation]) {\n                    response = apCachedXML.lists[fileName][operation];\n                } else if (_.keys(apCachedXML.lists[fileName]).length > 0) {\n                    /** The exact operation we'd looking for isn't found but there's another there so we'll try that */\n                    response = apCachedXML.lists[fileName][_.keys(apCachedXML.lists[fileName])[0]];\n                }\n                return response;\n            }\n\n            function responder(responseXML) {\n                return [200, responseXML];\n            }\n\n\n        }\n    }\n\n    angular.module('angularPoint')\n        .run(MockBackend);\n\n}"],"sourceRoot":"/source/"}