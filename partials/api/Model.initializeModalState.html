<h1><code ng:non-bindable="">initializeModalState</code>
<div><span class="hint">service in module <code ng:non-bindable="">Model</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="model-initializemodalstate-page"><p>Uses apModalService to return some general state information for a modal form using
the current user&#39;s permissions if an entity is passed in.  Otherwise we attempt to
return the user&#39;s permissions for the list.  We also include some additional flags
and with the use of the options param extend any other custom attributes on the returned
state object.</p>
</div></div>
<h2 id="usage">Usage</h2>
<div class="usage"><pre class="prettyprint linenums">initializeModalState([entity], [options]);</pre>
<h4 id="usage_parameters">Parameters</h4><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>[entity]</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="model-initializemodalstate-page"><p>SharePoint list item.</p>
</div></td></tr><tr><td>[options]</td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="model-initializemodalstate-page"><p>Object containing optional attributes that will be used
to extend the returned state object.</p>
</div></td></tr></tbody></table><h4 id="usage_returns">Returns</h4><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="model-initializemodalstate-page"><p>State object with flags.</p>
</div></td></tr></table></div>
<h2 id="example">Example</h2>
<div class="example"><div class="model-initializemodalstate-page"><pre class="prettyprint linenums">
Controller: app/modules/project/project_modal_ctrl.js
'use strict';
angular.module('App')
 .controller('projectModalCtrl', function (
                                             $scope,
                                             $modalInstance,
                                             projectsModel,
                                             apModalService,
                                             project
                                           ) {

     $scope.state = projectsModel.initializeModalState(project, {
          stateOption1: false,
          stateOption2: true
     });

     $scope.cancel = function () {
          $modalInstance.dismiss('cancel');
     };

     $scope.project = project;

     $scope.saveRequest = function () {
          apModalService.saveEntity(
             $scope.request,
             projectsModel,
             $scope.state,
             $modalInstance );
     };
});
</pre>
<pre class="prettyprint linenums">
View: app/modules/project/project_modal_view.html

&lt;div ng-form&gt;
    &lt;div class="modal-header"&gt;
        &lt;button type="button" class="close"
               ng-click="cancel()" aria-hidden="true"&gt;&times;&lt;/button&gt;
        &lt;h4&gt;Project Details&lt;/h4&gt;
    &lt;/div&gt;
    &lt;div class="modal-body"&gt;
        &lt;div class="well"&gt;
            &lt;div ng-form&gt;
                &lt;div class="form-group"&gt;
                    &lt;label&gt;Title&lt;/label&gt;
                    &lt;input type="text"
                       class="form-control" ng-model="project.title"/&gt;
                &lt;/div&gt;
                &lt;div class="form-group"&gt;
                    &lt;label&gt;Description&lt;/label&gt;
                    &lt;textarea rows="6" cols="50" class="form-control"
                              ng-model="project.description"&gt;&lt;/textarea&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="modal-footer"&gt;
        &lt;div class="pull-left"&gt;
            &lt;button class="btn btn-danger"
                   ng-click="deleteRecord()"
                  ng-show="project.id && state.canDelete"
                  ng-disabled="state.negotiatingWithServer"
                  title="Delete this task request"&gt;
                &lt;i class="fa fa-trash-o"&gt;&lt;/i&gt;
            &lt;/button&gt;
        &lt;/div&gt;
        &lt;button class="btn btn-primary"
           ng-click="save()"
           ng-disabled="project.title.length === 0 ||
               state.negotiatingWithServer"&gt;OK&lt;/button&gt;
        &lt;button class="btn btn-default"
           ng-click="cancel()"&gt;Cancel&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;
</pre>
<pre class="prettyprint linenums">
//Returns
$scope.state = {
   // Default "View" and once permissions are checked it
   // can also be "New" || "Edit"
   displayMode: "New",
   // Below 2 options allow for locking with 3 way
   // binding service like FireBase
   locked: false,
   lockedBy: '',
   // Flag which can be used to disable form controls
   negotiatingWithServer: false,
   userCanApprove: false,
   userCanDelete: false,
   userCanEdit: false,
   //User has admin rights
   fullControl: false
}
</pre>
</div></div>
</div>
